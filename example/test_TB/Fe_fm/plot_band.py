import os
import sys
file_path = sys.argv[0]
root_path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(file_path))))
sys.path.append(root_path)
sys.path.append(os.path.join(root_path,"module"))
import torch
import numpy as np


from module.physics_property.band.band import Band

band = Band()

band.get_data("/data/home/kongfh/DFTBAI1/example/BAND-total/Fe-fm/BAND.dat")
print(band.content['k_vector'].shape)
print(band.content["energy"].shape)

band_index = [i for i in range(5,10)]
model_index = [i for i in range(0,10)]

# band.plot_data("/home/hp/users/kfh/DFTBAI1/example/test_TB/Fe_fm/DFT_Fe_fm.png",band_index)

### Fm_fm,120ÂèÇ
para_input = torch.tensor([[ 3.1449e-01,  0.0000e+00,  3.0007e-02,  0.0000e+00, -9.2690e-01,
         -3.7285e-01, -2.2936e-01,  0.0000e+00,  6.8980e-02,  0.0000e+00,
          5.3294e-01,  6.2783e-02,  1.2501e-01, -5.4191e-02, -1.2231e-02,
         -4.7208e-02, -9.0949e-02,  6.2335e-02,  1.1595e-01, -9.7765e-02,
          1.0804e-01, -2.1678e-02, -3.2298e-02, -1.3410e-02,  5.2251e-02,
         -7.2765e-04,  1.3536e-01, -2.0920e-02, -1.4852e-02,  1.4811e-01,
         -2.0859e-02, -9.3634e-02,  2.7238e-02, -1.9935e-02,  1.2383e-01,
         -2.1883e-03, -9.7113e-02,  9.7155e-02, -1.0025e-02, -1.7065e-01,
         -1.0181e-01,  2.5016e-01, -9.5027e-02,  2.7337e-01,  6.9479e-02,
         -3.5618e-01,  2.1650e-01,  1.5806e-01,  5.0611e-01, -4.1914e-01,
          1.5540e-01, -1.1275e-01,  5.3532e-02, -6.8087e-02,  3.2597e+00,
          3.3361e-01,  2.9780e-02,  2.8940e-01, -1.0893e+00, -2.6000e-01,
         -1.9474e-01, -2.6407e-01, -1.4054e-01,  8.8622e-02, -4.1666e-01,
          2.6290e-01,  5.2873e-02,  2.4868e-01, -1.7100e-01,  1.2699e-02,
         -4.4764e-01,  1.5227e-01,  1.2062e-01, -5.8649e-02, -7.0634e-02,
          3.1310e-02, -3.1861e-02,  1.3649e-01, -5.9242e-02,  1.3077e-01,
         -4.3811e-04, -2.0002e-01, -4.4256e-02,  5.4767e-02,  3.7920e-01,
         -4.7832e-02, -3.6674e-01, -7.2432e-02, -2.3562e-02, -4.4001e-03,
          2.3851e-02,  4.5495e-02,  8.1945e-02, -5.5422e-04, -2.3433e-01,
          2.8355e-02,  7.3658e-02, -6.1697e-02, -1.6039e+00, -1.1442e-01,
         -2.6495e-01, -9.6550e-02, -1.5469e-01, -9.2616e-02,  6.5629e-01,
         -3.6192e-01,  3.7998e-01, -1.1027e-01,  1.1223e-01, -1.3882e-01,
         -3.8986e-02,  1.3866e-01, -5.6301e-02,  1.9620e-01, -8.8530e-03,
         -3.9165e-02,  7.9158e-02, -1.6928e-02, -5.6420e-02,  1.9008e-01]])

para_input = torch.tensor([[ 0.5943,  0.0000, -0.6445,  0.0000,  0.0095, -0.0068,  0.3205,  0.0000,
         -1.2016,  0.0000,  0.1670,  0.7586,  0.1214,  0.0279,  0.2129,  0.0293,
         -0.1010,  0.1867, -0.1076,  0.0467,  0.1055, -0.0171, -0.0536, -0.0688,
          0.1642,  0.0167, -0.0281,  0.0979,  0.0812, -0.0033,  0.1253,  0.0925,
          0.0868, -0.0192,  0.1133,  0.0750,  0.0671,  0.0487, -0.0358,  0.0343,
         -0.0632, -0.0891, -0.3891,  0.2237,  0.2932, -0.5733,  0.0569, -0.0834,
         -0.3071,  0.1311, -0.0475,  0.1569,  0.0412, -0.1485, -0.7354, -1.2618,
          0.4537,  0.3643,  0.3896, -0.9746, -0.7008,  0.6589, -0.6407,  0.3508,
          0.3141, -0.4933,  0.0389, -0.3493, -0.0711, -0.1867, -0.1177,  0.2762,
          0.0184, -0.0101, -0.1830,  0.0791, -0.0432, -0.0066, -0.0560,  0.0818,
          0.0381, -0.1271, -0.0818,  0.0566, -0.0264, -0.0298,  0.1540, -0.0978,
         -0.0341, -0.0651,  0.0875,  0.0168, -0.0414, -0.0738, -0.0294,  0.0117,
          0.1122, -0.0031,  0.4040, -0.2274,  0.5449,  0.0126, -0.0430, -0.1214,
         -0.1072, -0.2067,  0.4692,  0.1376, -0.1059,  0.2673, -0.1861,  0.1768,
          0.1277, -0.0802,  0.0703, -0.1296,  0.0540, -0.0213, -0.0631, -0.1475]])
para_input = torch.tensor([[-0.1843,  0.0000, -0.1066,  0.0000, -0.3413,  0.0310, -0.3671,  0.0000,
         -0.2873,  0.0000,  0.5620,  0.8698,  0.0719,  0.1354,  0.0829, -0.0052,
          0.1517,  0.0037,  0.0356,  0.0094,  0.0936,  0.1055, -0.0119, -0.0869,
         -0.1861, -0.0612, -0.0634,  0.0466, -0.0232, -0.0653, -0.0103,  0.0187,
          0.0997, -0.1064, -0.0296,  0.0529,  0.0691,  0.2002, -0.1183,  0.0072,
         -0.0163,  0.0145, -0.2549,  0.9675, -0.5260, -0.6280,  0.3424, -0.1586,
         -0.1989,  0.5252, -0.0763, -0.0289,  0.0527, -0.3192,  0.1687,  0.7279,
         -0.0614,  0.2710, -1.5266,  0.2956,  0.3532, -0.0674, -0.3359,  0.1610,
         -0.1634, -0.2882, -0.3514,  0.3023, -0.6763,  0.1592,  0.2528,  0.2994,
          0.0795,  0.0130, -0.1822, -0.1214,  0.0549, -0.0618, -0.0181, -0.1082,
         -0.0590, -0.2442, -0.2938, -0.0241, -0.2218,  0.0728,  0.1773,  0.1624,
         -0.0323, -0.0474,  0.0239,  0.0353,  0.0363, -0.0129, -0.0529, -0.0142,
          0.0656,  0.0685,  0.0248, -0.1681, -0.3175, -0.0389,  0.0275, -0.0307,
          0.8906,  0.2233, -0.2203,  0.0225,  0.0738, -0.1937, -0.0577,  0.0175,
          0.0949, -0.1591, -0.0950,  0.0920, -0.0155,  0.0808, -0.0573, -0.0658]])
para_input = torch.tensor([[ 4.9200e-02,  0.0000e+00,  6.9109e-02,  0.0000e+00, -3.9523e-01,
         -1.2625e-01,  6.6799e-01,  0.0000e+00, -7.4792e-01,  0.0000e+00,
         -7.6328e-02,  2.7877e-01,  3.7091e-02,  1.3595e-02, -1.3930e-01,
         -7.3517e-02, -3.8733e-02, -9.1443e-02, -1.1923e-02,  4.1225e-02,
          3.0363e-01,  9.1545e-02,  1.4786e-01,  1.6779e-01,  9.1781e-02,
          1.1640e-01, -7.9700e-02,  1.5894e-01, -5.5565e-02,  3.6893e-02,
          5.4138e-02, -6.1258e-02,  8.9168e-02, -1.6945e-01, -2.8555e-02,
         -5.7776e-02, -5.9651e-02, -1.0340e-01,  9.9114e-02, -2.1026e-01,
          2.0875e-02,  1.0228e-02, -2.1704e-01, -2.7917e-01,  2.6764e-01,
         -9.6811e-02, -7.5616e-02, -2.9943e-01,  1.8852e+00, -1.3079e+00,
          1.8812e-01, -3.2940e-01, -1.3345e-03,  7.7421e-02,  9.9770e-01,
          8.7876e-02,  2.4302e-01, -4.9756e-02,  7.3784e-01,  4.3755e-01,
          8.6107e-02,  3.0852e-01, -8.1428e-02, -5.1813e-02, -6.9890e-01,
          5.2265e-01,  2.7129e-01, -1.6245e-01, -1.7535e-01, -1.4449e-01,
          5.3179e-01, -4.7199e-01,  6.3907e-02, -5.2939e-02, -2.9306e-02,
         -1.1895e-02, -3.0568e-03,  5.8475e-02,  1.1928e-01,  1.7255e-01,
         -5.7972e-03,  3.3491e-02, -2.0201e-01,  3.2672e-02,  7.1824e-01,
          3.1362e-02, -8.7445e-01, -6.6382e-02, -6.1965e-02, -1.4805e-02,
          1.4597e-02, -6.4299e-02, -7.6069e-02,  1.4933e-01,  1.9267e-02,
          1.3704e-02,  2.8942e-02, -5.5898e-02, -6.0786e-01,  1.9085e-01,
         -3.3666e-02, -8.0323e-03,  6.9632e-02, -1.0036e-01, -4.0757e-01,
          1.1194e-02, -1.0434e-01, -5.8008e-02, -9.2900e-02, -5.2213e-02,
         -2.1612e-02,  7.2834e-02, -1.2189e-01,  3.2657e-01,  4.0898e-02,
         -1.9483e-03,  9.3077e-02, -2.5882e-02,  1.9226e-01, -2.0573e-01]])

para_input = torch.tensor([[-5.8774e-02, -5.1226e-01,  4.0488e-01,  1.6624e-01, -5.1494e-01,
         -7.5673e-01, -1.3557e-01,  6.2479e-02,  1.2138e-01, -4.2287e-01,
         -1.5733e-01,  5.9695e-01,  1.0123e-01, -1.3406e-02, -8.6785e-02,
          2.0762e-01, -2.3154e-02, -7.3850e-02,  8.6752e-02,  1.5819e-01,
          1.2685e-01,  9.0164e-04, -2.5429e-02, -1.5349e-01,  7.2685e-02,
         -7.8346e-02,  4.8970e-02, -4.0164e-02, -3.9844e-02, -1.7075e-01,
          6.5058e-02,  3.5186e-02,  1.2783e-03, -2.2241e-02,  2.3320e-02,
         -6.3466e-02, -1.8932e-01,  1.3748e-01, -1.5921e-01,  7.1796e-03,
          6.8073e-02,  2.3442e-01, -1.1066e-01, -8.8109e-01,  1.4263e+00,
         -3.0114e-01,  1.3629e-01, -7.6636e-02,  2.0478e-01, -3.1243e-01,
         -1.2112e-01,  3.0370e-02, -1.1506e-01,  9.8178e-02,  9.6379e-01,
         -1.1676e-01, -1.9534e-01,  1.2266e-01,  4.9151e-01, -1.8026e+00,
         -1.6494e-01, -1.7513e-01, -1.4888e-01, -1.5705e-02,  1.9004e-01,
          9.2868e-02,  7.0359e-01, -6.5265e-01,  3.6522e-01, -1.1275e-02,
         -7.8391e-01,  2.7506e-01, -5.6957e-01, -1.0640e-02,  3.8151e-01,
         -1.4954e-02, -1.4141e-02, -1.2947e-02, -1.0943e-01, -8.3472e-02,
          4.4003e-02, -1.4505e-01,  2.5993e-01,  4.3754e-02,  1.0209e-01,
         -7.3670e-02,  1.0047e-01,  1.7465e-02, -5.3580e-03, -7.3263e-04,
          4.3678e-02,  5.3398e-04,  1.4069e-01, -3.5407e-02,  1.6006e-01,
          1.2428e-02,  5.3074e-02, -3.8886e-02, -5.2384e-01,  1.1509e-01,
          5.8381e-02,  1.4395e-01,  5.5141e-03, -2.0238e-02, -2.9869e-01,
         -9.2296e-02,  9.4323e-01, -9.6184e-02,  6.1999e-02,  6.7859e-03,
         -2.4659e-03,  7.1380e-02, -6.1613e-02,  8.6191e-03,  2.1260e-01,
         -2.5833e-01,  1.0671e-01, -1.6343e-01, -1.3278e-01,  2.3387e-01]])
para_input = torch.tensor([[ 9.0137e-02,  5.2490e-01, -1.6743e-01, -2.2474e-01, -3.9247e-01,
         -5.0419e-01,  6.4452e-01, -1.8619e-01, -1.0495e-01,  2.3201e-01,
         -2.3696e-01,  5.3986e-01, -6.2470e-02,  3.5945e-02,  1.7914e-01,
         -4.0583e-02, -5.1062e-02,  8.9316e-02,  5.0254e-03,  6.0562e-03,
         -4.4418e-02, -7.0328e-02, -9.0038e-02,  5.7824e-02, -9.5563e-02,
          1.9807e-02, -8.6223e-02, -4.4080e-02, -3.7866e-02,  1.9580e-01,
          8.5126e-02,  1.5078e-03,  7.0287e-02,  3.3626e-01,  3.8093e-02,
          3.9200e-02, -9.3299e-04,  2.4748e-02,  1.2524e-01, -8.8006e-02,
         -2.8624e-02, -6.4086e-02, -6.2648e-02,  2.4574e-02, -7.5805e-02,
         -5.1880e-02,  1.6765e-02,  9.3798e-02, -7.1036e-01,  7.9309e-01,
          2.7599e-02,  3.3485e-01, -5.7509e-01,  1.2628e-01, -1.9368e+00,
          2.2449e-02, -3.1972e-01,  2.0555e-01, -1.1847e+00,  1.4137e-01,
         -1.8290e-01,  4.5478e-01, -5.6060e-01,  1.4940e-01, -2.9259e-01,
          8.9247e-02, -3.1279e-01,  1.5176e-01,  2.1977e-01, -4.6145e-02,
          3.2273e-02, -2.8230e-02, -5.4221e-02, -3.6134e-02,  1.5355e-01,
          8.7199e-02, -4.7530e-02, -1.8235e-02, -2.9225e-02, -1.2548e-01,
          8.7477e-02,  3.5019e-02, -5.1126e-03,  5.0941e-02, -5.0465e-01,
         -6.7973e-02,  5.2185e-01, -3.3743e-02, -5.8090e-02,  4.6002e-02,
         -1.7309e-01,  1.6148e-02, -3.5999e-02, -6.3973e-02, -2.4209e-01,
         -6.7303e-02, -9.7521e-02,  8.1210e-02,  1.0431e+00, -9.3968e-03,
         -2.3300e-01,  1.3627e-01, -3.3997e-02,  1.2277e-02,  8.1127e-01,
         -2.2044e-01, -1.2639e-01,  1.2871e-01, -6.0059e-02, -5.9599e-02,
         -2.1762e-02,  1.0407e-01,  3.2898e-02,  2.0826e-01, -7.5618e-02,
          8.9396e-02, -2.3574e-02, -1.1955e-01,  1.1466e-01, -4.9124e-02]])

### Fe_fm_pd_4neighbour
para_input = torch.tensor([[-5.2736e-01,  3.5617e-01, -5.0052e-01,  1.6044e-01, -7.9102e-01,
          2.3201e-01,  1.2233e-01, -1.4326e-01, -3.7523e-01, -4.6016e-01,
         -3.3698e-01,  2.8494e-01, -1.0092e+00, -3.1703e-02,  6.8307e-01,
          3.5613e-02, -8.0925e-01, -1.2449e+00, -1.6880e-01, -1.2109e-01,
          5.0521e-01,  7.6710e-03,  2.9270e-02, -8.0250e-02,  6.8801e-02,
         -2.3775e-02,  1.4562e-03,  4.7476e-03, -2.1496e-01,  1.5121e-02,
         -2.7325e-02, -4.8633e-02, -9.1380e-02,  9.0212e-02, -4.8712e-03,
          1.0128e-01, -9.6062e-02, -1.7488e-02,  6.1155e-02,  1.1928e-01,
          1.5179e-02,  7.6229e-02,  9.6595e-03,  4.9617e-03,  3.3317e-02,
          1.0961e-01,  7.1123e-02, -3.0127e-02, -1.6231e-03, -2.2411e-02,
         -6.8654e-03, -1.7878e-01, -2.5799e-02,  1.0657e-01, -1.7923e-01,
         -4.9913e-02,  1.1463e-01,  2.1647e-01,  6.8728e-02,  7.5003e-02,
          3.6430e-02,  2.9266e-02,  6.5068e-03,  9.5980e-02,  9.1702e-02,
         -7.4628e-03, -8.0343e-02,  4.7968e-02,  4.4898e-02,  4.8794e-02,
          1.1987e-01, -5.2652e-02,  1.1862e-01, -1.6978e-01, -6.4694e-02,
         -1.1647e-01,  6.0457e-02,  3.1121e-01,  9.3243e-02,  2.2922e-02,
         -2.9591e-03,  3.7003e-02, -2.5025e-02,  1.1916e-01, -2.3706e-02,
         -7.3856e-03,  2.5248e-01,  6.8268e-02, -5.4552e-03, -3.9994e-01,
          2.5225e-01, -7.6653e-02,  4.5029e-01, -2.4175e-01, -1.5140e-01,
         -1.6674e-01,  2.1244e-02,  2.5653e-03, -2.1396e-01,  1.7172e-01,
         -1.0294e-02,  3.4206e-02, -1.4960e-01, -2.2717e-01, -3.2591e-01,
          3.5798e-01, -1.5605e-01,  1.5791e-01, -2.7750e-02,  1.1633e-01,
          7.2018e-03, -5.0842e-02, -2.3828e-01,  2.9350e-01, -3.0489e-04,
          1.3722e-01,  4.8422e-01, -1.6193e-01, -1.4485e-01, -5.9806e-02,
         -7.8733e-03,  5.1707e-02,  2.7570e-02,  2.2942e-02,  2.8981e-02,
         -1.4952e-01, -4.7131e-03,  4.4809e-01, -6.0736e-01,  1.5419e-02,
         -1.0095e-01, -1.6596e-01,  1.2210e+00, -1.0684e+00, -1.3083e-01,
         -1.7484e-01, -4.8014e-01,  4.3024e-01, -9.6914e-02,  1.1411e-01,
         -3.5089e-01,  2.5024e-01, -7.5418e-01,  9.1523e-01, -2.9022e-02,
          3.2092e-01, -1.3959e-03, -7.6960e-02, -6.6337e-01,  3.6047e-01,
         -6.9442e-02,  4.6081e-02,  6.0114e-02, -1.2480e-02,  5.5845e-01,
          1.5923e-01,  8.0872e-02,  2.1815e-01, -1.3431e-01, -1.5564e-01,
         -7.0508e-02,  1.5332e-02,  2.8604e-02,  5.9582e-02,  5.8192e-01,
         -5.0749e-01, -3.9257e-02,  1.0704e-01,  1.0596e-01,  8.5456e-02,
         -2.3715e-02, -9.0646e-02, -1.5095e-01, -9.4058e-02,  1.0941e-02,
          5.4223e-02, -3.0854e-02,  5.1941e-02, -3.0638e-01,  3.8582e-01,
         -1.8427e-01,  6.2938e-02, -3.9824e-02, -6.9941e-02,  1.1825e-02,
          1.9487e-01,  8.5866e-02, -1.3320e-01, -2.4478e-01,  1.4374e-01,
          1.1578e-01, -1.9679e-02, -1.2793e-01,  1.9653e-01,  6.9695e-02,
         -4.7462e-02,  5.0294e-02,  1.0467e-01, -2.8370e-02,  7.3162e-02,
          1.3478e-01,  1.6569e-02, -1.6288e-01, -3.7493e-02,  9.7889e-02,
         -2.9885e-01,  8.8857e-02,  4.6263e-02, -1.9345e-02, -1.3354e-01,
          1.5519e-01,  6.3833e-01,  2.0109e+00,  3.2884e-02, -1.0244e-01,
          1.7584e-01, -1.6350e-01,  1.5215e-01,  7.2950e-02,  1.3000e-01,
         -2.6456e-01, -9.5043e-01,  5.3975e-01, -1.1040e-01, -2.1897e-01,
         -1.9325e-01, -8.7085e-02, -1.0207e-01,  7.6069e-02, -3.1953e-02,
         -2.1105e-02,  2.0317e-02,  1.4318e-01, -1.1970e-01,  6.4480e-01,
         -1.0142e-02, -6.5626e-01,  1.1910e-02,  4.9453e-02, -7.6213e-02,
         -7.8753e-02,  4.7757e-02, -1.2130e-01,  6.2649e-02, -2.1172e-01,
          2.0987e-01, -3.4009e-01,  2.0253e-01, -3.6197e-03, -6.4055e-02,
         -3.4161e-02, -3.1062e-02,  1.6247e-01, -7.7238e-03,  5.5151e-01,
          1.0351e-02, -5.0840e-01, -1.1637e-01, -2.0612e-01,  1.8081e-01,
          7.8355e-02, -5.3351e-02, -1.8420e-01, -1.3760e-01, -1.2121e-01,
         -2.1241e-02,  7.2787e-04,  1.2310e-03,  2.7702e-01,  4.6986e-01]])

# para_input = torch.tensor([[-1.8390e-01, -5.1506e-01, -3.2071e-01,  3.2842e-01,  1.3238e+00,
#          -6.8113e-01, -2.3519e-01, -2.6163e-01, -8.9935e-01, -2.6794e-01,
#          -1.5689e+00, -5.4847e-01,  4.1513e-01, -5.1470e-01,  5.1912e-01,
#           1.2126e+00,  1.2686e+00, -1.6816e+00,  8.0107e-02, -3.9334e-02,
#           1.4303e-02,  1.3163e-02, -1.0496e-01,  1.4606e-02, -9.9256e-03,
#          -6.0354e-02, -1.5407e-02, -8.3202e-03, -2.7184e-02, -9.8840e-04,
#           6.6471e-02,  2.2421e-02,  3.1952e-02,  1.2610e-01, -9.6037e-02,
#          -9.4310e-02,  1.7932e-02,  9.9281e-02, -1.0185e-01,  2.0416e-02,
#           9.1083e-02,  3.3094e-02,  5.3970e-02,  4.0759e-02, -3.2837e-02,
#           3.6451e-02,  7.8600e-05, -6.5770e-02, -2.5071e-01, -1.0245e-01,
#           6.7065e-02,  3.9264e-04, -2.0447e-02, -3.2501e-02,  2.3692e-01,
#          -2.2607e-02,  3.6164e-02,  5.6524e-02, -1.6958e-02, -1.3714e-01,
#           1.0162e-01,  1.3277e-01,  1.1382e-02,  8.5995e-02, -1.1238e-01,
#           1.8389e-01,  1.1803e-01, -2.2732e-03,  1.2965e-01,  3.1634e-03,
#           9.4868e-02,  1.3765e-01, -4.4036e-01, -3.3987e-02, -2.2027e-02,
#           5.3516e-02, -4.9613e-02, -1.0870e-01, -3.9557e-01,  1.5227e-01,
#          -3.5369e-03, -3.1027e-02, -2.2144e-02,  2.9919e-02,  4.6888e-02,
#           1.7542e-03, -1.6276e-01, -1.2195e-01,  1.3860e-01, -3.8965e-01,
#          -1.9525e-01,  1.8486e-01, -4.4564e-02,  2.1932e-01, -3.8761e-01,
#          -4.3293e-02, -1.0154e-01,  9.0858e-02,  8.5622e-02,  1.1236e-02,
#           2.3009e-02,  4.9031e-02,  7.7762e-02, -6.0389e-02, -4.7728e-01,
#           6.0674e-01,  1.4119e-02, -4.3158e-02, -3.0270e-02, -8.3863e-02,
#           4.8477e-02, -5.6587e-02, -8.5381e-03, -8.6755e-02, -6.3461e-02,
#           3.5207e-02, -5.6941e-01,  6.2502e-01,  1.6736e-02, -7.7752e-02,
#           8.1254e-03, -1.1844e-01,  1.7385e-01, -6.4016e-03, -3.8306e-02,
#          -3.2338e-01, -8.4416e-02, -8.8186e-01,  8.5644e-01, -1.5733e-01,
#           9.4502e-03,  9.7374e-02, -5.6433e-01,  6.3414e-03,  3.7554e-01,
#          -7.1760e-02,  1.6613e+00, -4.4332e-01,  2.8736e-01, -6.4992e-01,
#          -6.1058e-03,  1.4495e-01, -3.2981e-01, -2.0041e-01, -3.3639e-01,
#           1.8418e-01,  1.7590e-01,  7.7937e-02, -4.1118e-01,  5.6404e-01,
#          -6.8387e-01,  5.8579e-01, -1.4663e+00,  8.2882e-01,  1.3912e+00,
#          -1.1575e-01,  2.3128e-01, -5.4717e-03, -2.0965e-01,  1.0221e-01,
#          -1.3800e-01, -1.3622e-01, -6.8976e-02,  2.2469e-02,  1.8387e+00,
#          -1.7480e+00, -4.7254e-02, -1.2711e-02, -6.0229e-02,  1.1861e-01,
#           2.3544e-01,  7.6551e-02, -4.6528e-02,  9.9432e-02, -1.9471e-01,
#           1.4993e-01,  1.3499e-01, -1.2692e-01, -6.1401e-01,  5.9671e-01,
#          -1.3602e-01,  2.1264e-02,  1.1256e-01,  9.9663e-02, -1.0854e-01,
#           7.1976e-02,  4.0514e-03,  3.4209e-02,  1.6804e-01, -1.4595e-01,
#          -3.6390e-02,  4.4266e-02, -4.0923e-03,  1.0546e-01,  3.2719e-02,
#          -5.3793e-02, -1.0046e-01, -2.6161e-02, -6.7932e-02, -6.1385e-02,
#           8.9246e-02,  1.2783e-03,  2.5280e-01, -3.6380e-01, -3.7208e-01,
#          -1.8840e-02,  2.1841e-02,  6.8916e-02,  1.6828e-01,  2.1252e-01,
#          -2.4650e-01,  3.3606e-01,  6.9654e-01, -6.6779e-02,  1.0019e-01,
#           5.8331e-02, -1.0800e-01,  1.0110e-01, -6.3555e-02, -1.1618e-01,
#          -1.3600e+00,  4.6421e-01, -3.6442e-01,  3.4823e-02,  4.4667e-01,
#           4.8792e-02, -4.9895e-03, -2.5959e-02, -3.4308e-02, -1.4961e-01,
#          -2.9957e-02, -4.5911e-02, -7.2847e-02,  9.6272e-02,  1.1671e-01,
#           2.1010e-03,  4.2524e-02, -6.7261e-02,  4.0659e-02,  5.1265e-02,
#          -1.0045e-01, -5.1331e-03, -7.0684e-02,  9.3127e-02, -2.3253e-01,
#           5.2347e-02,  6.2997e-01, -5.0643e-02, -1.1422e-01, -1.6946e-01,
#           2.9160e-01, -7.0620e-02, -4.2213e-02, -1.4109e-01,  1.1969e-01,
#           7.1500e-02,  4.1506e-02, -1.1845e-01, -4.6661e-02,  1.3835e-01,
#          -1.1890e-01,  4.7649e-01, -2.3866e-01,  4.6559e-02, -2.0853e-01,
#           2.2901e-01, -5.2804e-01,  1.3462e-01,  3.4665e-01,  4.4871e-01]])

# ### Fe_fm_pd_5n
# para_input = torch.tensor([[-5.9569e-01,  7.6773e-01, -2.3512e-01, -3.7569e-01, -3.1113e-01,
#          -2.6137e-01, -1.9963e-01,  2.5715e-01, -1.0271e+00, -3.9586e-01,
#          -5.0403e-01,  6.2558e-01,  5.6369e-01,  5.7594e-03,  2.4002e-01,
#          -3.3921e-01, -4.2335e-01, -1.5645e-01,  4.5331e-02, -2.1440e-02,
#          -9.7821e-03,  1.0520e-01,  7.1258e-01,  1.1362e+00, -1.4506e-02,
#           3.1592e-02, -8.3030e-02, -1.4047e-01,  1.2951e-01,  3.0806e-02,
#           2.6074e-03,  1.1494e-01, -8.5200e-01, -1.3543e-01,  9.4298e-02,
#          -1.8146e-01,  1.3299e-01, -4.8249e-02, -2.0864e-01, -3.8322e-03,
#           9.0588e-02, -1.3096e-01,  5.1061e-02, -2.4392e-02,  2.2741e-02,
#           4.1380e-02,  4.0433e-02,  1.4280e-01, -7.1742e-02, -2.0772e-02,
#          -6.5351e-02,  1.4116e+00,  1.9162e-02, -5.1957e-02, -2.2164e-02,
#           3.9247e-02,  1.3433e-01,  4.5107e-01, -1.5199e-01,  4.5423e-02,
#           1.3834e-02, -8.3740e-01, -5.6639e-01, -8.3353e-01,  1.4303e-02,
#          -1.3692e+00,  9.4436e-01, -6.4162e-02, -6.1198e-02,  1.3601e-01,
#          -5.4129e-01, -3.0136e-01,  3.6393e-01,  9.8915e-01,  7.4957e-01,
#          -8.5499e-01,  5.4894e-02,  1.7764e-01,  5.4177e-02, -3.7595e-02,
#           4.5284e-03,  8.6073e-02,  6.5830e-02, -7.1927e-02, -1.1592e-01,
#          -6.1101e-02,  3.4627e-02, -7.5035e-02, -2.1477e-01,  1.7853e-01,
#           5.0228e-02,  2.4027e-01, -3.0570e-01, -6.0935e-01,  2.7637e-01,
#           9.7737e-03,  3.6970e-02, -2.6111e-02, -4.8898e-02,  1.9026e-02,
#          -8.4962e-03,  7.9447e-02,  2.9152e-02, -5.5958e-02, -3.6400e-02,
#           5.0896e-01,  1.5913e-01,  4.6571e-02, -7.3492e-02,  9.3370e-02,
#          -2.7783e-01, -8.8095e-02, -7.5714e-02,  2.5268e-01, -4.7247e-02,
#          -8.7734e-02,  1.8996e-01, -1.9676e-01, -1.9258e-01, -1.9867e-02,
#          -1.9330e-01, -3.2056e-02, -3.0975e-02,  1.9336e-01,  5.5398e-02,
#          -1.8164e-01, -1.6057e-01,  2.9140e-01,  8.1804e-02, -2.3728e-01,
#           3.4364e-01,  1.3960e-01, -4.6761e-01,  1.9335e-01, -3.3494e-02,
#           9.8962e-02, -1.2964e-01,  2.3449e-01,  2.5311e-01, -3.8584e-01,
#          -4.1157e-02,  1.3123e-01, -8.8346e-01,  5.7726e-02, -2.6119e-01,
#           4.6892e-01,  2.1300e-02,  1.8476e-01, -6.6535e-01,  2.6271e-01,
#           1.1242e-01,  2.4399e-01,  2.5016e-01,  1.1910e-02, -8.9714e-03,
#           4.0358e-01,  1.4045e-01, -4.4225e-02, -1.2467e-01, -2.1933e-01,
#           1.7060e-01, -1.2514e-01,  4.5409e-02, -6.7141e-02,  1.0881e+00,
#          -1.1923e+00,  4.8452e-02,  5.7913e-02, -1.1735e-01,  1.7340e-02,
#           1.0454e-01,  9.8503e-02, -5.2377e-02, -1.0351e-01,  5.7126e-02,
#           6.3484e-03,  6.7799e-02,  2.0308e-02, -4.3561e-01,  4.7392e-01,
#          -3.1394e-01,  1.8908e-01,  3.1880e-01,  1.1431e-01, -1.0503e-01,
#           1.3007e-01,  3.6960e-02,  8.3798e-03, -3.9467e-01,  3.6595e-01,
#           2.8121e-02, -1.4510e-01, -1.8797e-01,  3.2650e-02,  1.0427e-02,
#          -8.0581e-03,  6.7115e-02,  1.4087e-01,  9.9774e-02, -1.4664e-01,
#          -8.1615e-02, -1.2163e-01,  2.7584e-01, -2.6170e-01,  1.0687e-01,
#          -1.2264e-01, -3.6537e-02, -2.8504e-03, -1.8521e-02, -9.4216e-02,
#          -5.3284e-03, -5.7909e-02,  3.9655e-01,  8.5929e-02, -1.0847e-01,
#          -8.3219e-02,  3.4450e-02, -5.2244e-02, -3.7191e-02,  9.1272e-02,
#           1.7837e-02,  7.0473e-01, -1.5701e-01,  8.1138e-02,  2.2439e-02,
#          -1.9702e-02, -4.0120e-02, -1.1551e-02,  4.3853e-03,  1.4515e-02,
#           4.7889e-02, -1.3245e-01, -3.2822e-02,  1.1994e-01, -3.1212e-02,
#          -2.9621e-02,  2.0019e-01, -6.3706e-03, -7.4713e-02,  6.9193e-02,
#          -7.9584e-02,  3.8802e-02,  1.0396e-01, -6.5023e-02,  1.7245e-01,
#           1.0258e-01, -1.2727e-01, -3.7349e-02, -1.1693e-01, -6.3071e-02,
#           1.2204e-01,  4.5979e-02, -1.4268e-01, -2.2683e-01,  5.1366e-01,
#          -4.8834e-02, -3.2551e-02, -1.1890e-02,  6.3991e-02,  2.4295e-01,
#           4.7957e-02,  1.3396e-01, -1.6460e-01,  2.4095e-01, -1.5627e-01,
#           3.6297e-01,  1.7596e-01,  8.7640e-02, -1.5866e-01,  1.5715e-01,
#          -6.2988e-02,  1.1366e-01, -4.4774e-03,  4.1964e-02,  6.1374e-02,
#           5.7594e-02, -1.7330e-03,  2.4691e-01, -7.7442e-01, -1.1030e-01,
#           1.1699e+00, -3.0462e-01,  3.9066e-01,  5.6810e-01,  1.5552e-02,
#           3.0896e-01, -1.1243e+00, -1.9045e-01, -1.1565e+00,  3.4281e-02,
#           5.9853e-02,  1.5716e-02, -1.3010e-01,  8.0147e-03, -9.0608e-03,
#          -2.8819e-02, -2.0829e-01,  7.2393e-02,  4.4927e-02, -1.2139e-02,
#          -1.0146e-01, -1.0023e-02,  6.8718e-02,  5.4346e-02, -3.0560e-02,
#           4.5599e-02, -3.0206e-02,  4.6346e-02, -3.9237e-01,  3.9462e-02,
#          -3.7876e-01, -2.8249e-02,  3.9270e-02, -4.4224e-02, -1.5008e-01,
#          -4.0992e-02, -1.0783e-01,  3.8826e-02, -2.5749e-02, -7.2149e-02,
#          -7.1452e-01, -1.4190e+00, -1.0898e-01,  1.2251e+00,  6.9553e-01,
#          -2.6486e-02, -2.1044e-01,  1.2751e-02, -1.3097e+00,  3.4116e-02,
#          -1.1153e+00,  4.7741e-02, -6.4487e-03,  2.6644e-01, -9.9894e-04,
#          -1.8243e-01, -6.4446e-02,  1.1306e-02, -4.7535e-02,  7.3667e-02,
#           2.4973e-03, -2.5548e-02, -1.5936e-02,  4.0097e-02, -1.2085e-01,
#          -5.3595e-03,  2.7783e-02,  1.9423e-02, -4.3148e-02, -3.4307e-03,
#          -8.4515e-02,  7.7348e-02, -6.6969e-01,  2.7810e-02, -6.2078e-01,
#           6.7614e-02,  4.0844e-02, -3.9320e-02, -5.8375e-02, -1.3040e-02,
#           7.3915e-02, -8.8327e-03,  5.7053e-02, -3.4489e-02, -7.5002e-01,
#          -3.5328e-01, -1.4133e+00, -7.7051e-03, -2.0201e-01, -3.3318e-03,
#          -2.7275e-02,  1.8665e-02,  7.1093e-01,  1.3350e-02, -3.7595e-02,
#           1.6741e-02, -7.3832e-02,  2.4058e-02,  6.0648e-02, -9.5903e-02,
#          -2.6892e-02, -1.0370e-01, -1.0387e-01, -1.1039e+00, -6.1643e-02,
#           5.8285e-02,  8.4582e-03,  7.9505e-02,  6.3727e-02, -6.4067e-01,
#           4.0542e-02, -4.3609e-03,  5.2850e-02,  5.1187e-01, -2.7474e-01,
#           4.6565e-01, -1.2518e-01, -3.6730e-02, -2.7697e-01, -4.6377e-01,
#          -5.0785e-02,  3.6839e-01,  2.2111e-02,  8.7525e-01, -2.6949e-02,
#          -3.5772e-01,  9.4430e-01, -4.0140e-01, -4.8913e-01, -7.1404e-01,
#          -1.3377e+00, -1.2173e-02, -6.9816e-02, -1.0053e-01,  2.9511e-03,
#          -4.1777e-03,  1.5168e-01, -2.7479e-02,  1.0066e+00, -3.3958e-01,
#           2.6013e-01,  1.5543e-01, -6.0358e-01, -1.2563e-01,  5.7938e-01,
#          -2.7345e-01, -1.9020e-01,  8.1413e-01, -7.7774e-01,  5.1040e-01,
#          -2.6445e-02, -5.6083e-01,  4.0476e-01,  3.8034e-01,  3.9406e-01,
#           1.0611e+00,  5.9209e-03, -2.0068e-01,  4.5589e-02,  2.5310e-02,
#           1.3441e-01, -6.8906e-03, -3.1091e-02,  2.3685e-02,  2.7740e-02,
#           3.3119e-02, -7.5402e-02,  7.6963e-02, -1.4151e-01,  1.6421e-01,
#           4.4503e-02,  1.3257e-01,  4.9532e-03, -5.8851e-02, -1.0456e-02,
#           1.0263e-02, -2.1264e-02, -6.1732e-02, -4.1604e-02,  1.0883e+00,
#          -7.7578e-02,  5.5255e-02, -4.0658e-02,  2.1739e-01,  4.8488e-01,
#          -2.8528e-02,  1.0863e-01, -1.5902e-01, -2.0314e-01,  2.1596e-02]])

para_input = torch.tensor([[-4.9529e-01, -2.5829e-01,  1.8084e+00,  1.6770e-01,  4.5178e-01,
          5.1785e-01,  4.5287e-01, -1.3064e+00, -5.2472e-03, -7.5423e-02,
         -1.6441e-01, -4.2608e-01, -1.4716e+00,  2.5030e-01,  5.4000e-01,
          5.6840e-01, -4.9181e-01, -7.8888e-01,  4.0902e-01,  2.8619e-02,
         -1.6454e-01, -1.8530e-01,  1.0324e-01,  9.0410e-01, -3.0168e-01,
         -2.0758e-01,  5.4764e-01,  2.2392e-01, -1.7279e-01, -6.3358e-02,
         -6.7808e-02,  4.2614e-01, -1.1838e+00,  6.3794e-01,  5.8586e-01,
          5.8853e-01, -1.0083e+00,  4.2480e-01,  4.7144e-01, -7.7306e-01,
         -2.5606e-01, -2.5496e-01, -6.4376e-01,  4.6307e-01, -4.6235e-01,
         -1.1580e+00,  4.2796e-01,  8.2185e-01, -3.1239e-01, -3.8272e-01,
         -1.9422e-01, -3.1119e-01,  1.0857e+00, -2.0855e-01, -9.0777e-02,
          1.1010e-01, -3.7851e-01, -6.6184e-01, -6.7016e-02, -7.8157e-02,
         -1.3443e-01,  3.0476e-01, -1.0276e+00,  8.6479e-01,  1.2023e+00,
         -3.3484e-01,  5.1915e-01, -4.7867e-01,  1.3027e-01,  2.0992e-02,
         -2.3715e-02, -1.3189e+00,  4.8732e-01,  1.2920e-02,  5.3831e-02,
          1.7875e+00, -1.8420e-01, -7.4824e-01,  7.8318e-01, -1.0998e+00,
          3.3160e-01, -1.5320e-01,  4.9699e-01,  8.3674e-02, -5.7123e-01,
          1.2278e-01, -3.3371e-01, -8.5866e-01, -9.6549e-02, -1.4808e+00,
          8.6628e-01,  1.6970e+00,  2.8569e-01, -1.6972e+00, -9.9142e-01,
         -3.9499e-01,  7.0622e-01,  6.7770e-01,  4.0880e-01, -1.5524e-01,
          1.7008e-01, -3.4875e-02,  2.7107e-01, -4.0917e-01,  4.5276e-01,
         -1.0568e+00,  1.4021e+00,  8.9343e-01,  9.7222e-01,  3.2012e-01,
         -1.0334e+00,  9.7528e-01,  2.3375e-01, -2.3941e+00,  5.7057e-02,
         -4.5246e-02, -1.6845e+00,  8.4618e-01, -3.1774e-01, -1.4516e-01,
          5.0431e-01, -2.0823e+00,  1.1049e+00, -1.0739e+00, -4.2117e-01,
          2.0012e+00,  4.4107e-01, -2.3822e-01, -7.5834e-01, -5.3283e-02,
          9.7502e-01, -5.4926e-01,  2.1046e-01, -6.7210e-01,  1.5051e+00,
          2.0027e-01,  1.7526e+00, -9.7094e-02, -1.3353e+00,  1.0243e+00,
          3.6674e-01,  1.8524e+00,  7.1404e-02, -2.0704e-01,  9.0345e-01,
         -5.9665e-01,  9.9323e-01, -3.9516e-02,  7.5031e-01, -4.9611e-01,
          7.5555e-01, -4.2733e-01,  5.7334e-01, -3.8769e-01, -1.4663e+00,
          8.0494e-01, -9.2425e-01,  2.4744e-01,  7.9034e-01, -3.8784e-02,
          7.0661e-01, -1.9869e-01,  3.8317e-01,  6.0900e-01,  1.5085e-01,
         -8.7615e-02, -2.8829e-01, -2.9841e-01, -6.6573e-04, -5.4763e-01,
         -3.7001e-01,  4.6946e-01, -4.9490e-01,  2.4136e-01, -3.0932e-01,
         -1.1587e-02,  1.5634e-01, -1.7202e-01,  2.5324e-01, -4.4488e-01,
          1.0216e-01,  6.0907e-01,  2.4169e-01, -1.8026e-01,  9.7766e-01,
         -3.1914e-01,  7.2062e-01, -1.9292e-01,  3.7159e-01,  7.0580e-02,
          2.9883e-01,  3.3772e-01,  2.9291e-01,  2.6511e-01, -3.0139e-01,
         -4.9169e-01, -5.7434e-01, -4.8959e-01,  1.3385e-01,  2.7466e-01,
         -1.2006e+00,  7.7657e-01,  3.5171e-01,  2.0620e-01, -7.3051e-01,
         -1.3433e-01, -2.3440e-01, -1.0553e-01, -3.8027e-01,  3.6736e-01,
         -5.6481e-02,  6.8326e-01,  9.5049e-01,  7.9563e-01, -1.2791e+00,
          1.9727e-01, -1.4141e-01, -2.7559e-01, -3.6344e-01, -3.8661e-01,
         -4.7410e-01, -3.1097e+00,  1.1811e+00,  7.7184e-01,  5.8601e-01,
          2.2333e-01,  6.9692e-01,  5.0244e-04, -1.5285e-01,  3.7634e-01,
          1.8780e-01, -1.1347e+00,  4.9608e-01, -6.7446e-01,  2.1354e-01,
         -1.3986e-02, -2.4002e-02,  8.8212e-01, -1.3405e+00, -1.0745e-01,
          1.9206e-01,  4.4110e-01, -5.2717e-01,  4.4444e-01, -6.6264e-01,
          5.0051e-01,  4.2736e-01,  5.2833e-02,  6.0698e-01, -6.0071e-02,
         -4.7009e-01,  1.0575e-01, -1.2516e+00,  3.1220e-01, -3.5627e-01,
          3.3825e-02, -2.7846e-01,  3.6762e-01, -9.4502e-01, -2.5854e-01,
         -3.1795e-01,  6.4530e-01, -4.5673e-01, -1.5872e+00, -5.3258e-01,
         -2.1256e+00,  1.4673e-02,  3.2740e-02, -1.1921e+00, -8.7059e-01]])


### Fe_fm_d_3n
para_input = torch.tensor([[ 2.4506e-01,  2.7450e-03,  7.6146e-01,  3.0962e-01,  1.8848e+00,
          1.9373e+00,  9.1595e-02, -1.6090e-01,  9.0992e-01,  1.4683e+00,
          1.1314e+00,  8.1825e-01, -2.0893e-02, -2.1694e-02,  7.7546e-02,
         -1.5938e-02,  4.6290e-03,  7.1133e-02,  3.6148e-03, -6.0093e-02,
          2.3573e-03,  1.7077e-02, -6.2977e-02, -2.9530e-03,  2.2098e-01,
         -2.3591e-01,  1.3002e-01,  2.2903e-01, -3.9031e-02, -1.7580e-02,
          2.2931e-01,  6.4525e-02,  1.0149e+00, -5.7206e-01, -5.4146e-03,
          5.5369e-03,  3.3809e-03,  7.3516e-02, -4.7077e-01, -1.9726e-01,
          1.8482e-01, -8.8236e-02, -4.5105e-02,  4.5224e-02,  4.5503e-02,
         -1.2508e-03, -6.6264e-03, -2.2781e-01,  1.2477e-01,  5.9294e-02,
         -3.2495e-01,  7.4167e-02,  1.6625e+00, -1.4596e+00,  4.8298e-01,
          1.2533e+00, -4.0159e-01,  6.2306e-01, -1.2238e-01, -4.7722e-01,
         -2.9953e-01,  1.4458e-01, -8.9772e-02, -3.9960e-02,  1.8044e-01,
          4.4333e-01,  9.2700e-03,  4.8533e-01,  2.5786e-01, -4.7532e-01,
          2.3155e-01,  6.4427e-01]])
para_input = torch.tensor([[ 0.1158, -0.6583,  0.2107, -0.5769, -0.5262, -0.2200,  0.1365, -0.9053,
         -0.9892, -0.8783, -0.3283,  1.2133, -0.0288, -0.0046,  0.0771,  0.1442,
          0.1707, -0.0764,  0.0538,  0.0469,  0.1721,  0.0541, -0.2035,  0.0374,
          0.1687,  0.0791,  0.0528,  0.0935, -0.0158,  0.2200,  0.0612, -0.0312,
          0.0527,  0.0566,  0.0352, -0.0902,  0.1168,  0.0438, -0.0472,  0.1796,
         -0.1723,  0.1410, -0.0774, -0.1528,  0.4049,  0.4036, -0.0229, -0.1840,
          0.4668, -0.2977,  0.1651,  0.0050, -0.1536,  0.1999, -0.0229,  0.2057,
         -0.1321,  0.0720,  0.2085,  0.3494, -0.3613,  0.2790,  0.4521,  0.0881,
         -0.3065, -0.0836, -0.1153,  0.0206,  0.5119, -0.0141, -0.2349,  0.0678]])

# ### Fe_fm_4n
# para_input = torch.tensor([[-2.5497e-01,  1.0800e+00,  3.3726e-01, -9.2689e-01,  1.6372e-02,
#          -6.4506e-02,  4.1626e-01, -8.7084e-02, -3.3598e-01,  8.9487e-01,
#          -1.0684e-01, -3.1225e-01, -4.3955e-02,  6.4232e-02, -4.2312e-02,
#          -1.9708e-02,  1.1256e-01, -3.2624e-02, -9.6776e-03, -4.1065e-02,
#           7.0257e-02,  1.6551e-02,  4.0196e-02,  1.0865e-01, -3.0415e-02,
#           8.7491e-02,  4.6757e-03, -6.1106e-02,  5.9185e-03,  3.2690e-02,
#           6.5467e-02,  2.8424e-02, -8.3289e-02, -2.7262e-02,  1.2712e-01,
#           9.6563e-02, -5.2404e-03,  4.4718e-02, -1.9702e-02, -9.2166e-02,
#           9.9476e-02,  1.3578e-01,  5.1050e-02, -5.3533e-01,  7.5174e-01,
#          -7.0983e-02, -2.0983e-02, -1.3026e-01, -4.6591e-01,  6.3053e-01,
#           9.1822e-03,  1.8654e-02, -9.3578e-02,  6.6768e-02,  6.9225e-01,
#          -1.3790e+00, -2.1861e-01, -1.9769e-01, -5.9880e-01, -3.9573e-02,
#           2.0047e-01,  2.5763e-01, -3.1257e-01,  1.6575e-01,  4.1231e-01,
#          -4.0095e-01,  6.1070e-02,  1.4544e-01, -3.7201e-01,  2.1258e-01,
#          -7.4053e-01,  4.7538e-01, -1.9655e-01, -9.8592e-02,  2.6713e-01,
#          -1.5137e-01,  5.4532e-02,  2.3179e-04,  3.4326e-02,  3.5573e-02,
#          -4.4230e-02,  9.7665e-02, -1.9455e-01,  3.3304e-02, -1.3810e-01,
#          -5.0623e-02,  2.6531e-01,  6.2640e-02,  2.7399e-03, -6.9422e-03,
#          -5.0011e-02, -7.7733e-02,  4.3446e-02, -1.5234e-02, -4.2895e-02,
#           2.5767e-02, -1.9319e-02, -1.2471e-02, -3.2860e-01,  2.2440e-01,
#           7.0928e-01,  1.6678e-01,  5.7878e-02, -4.5426e-03,  2.3528e-01,
#          -1.2833e-01,  1.5205e-02,  5.9357e-03, -2.1081e-03, -1.7620e-02,
#          -1.6554e-02,  1.9228e-01,  1.7132e-01, -1.2994e-01,  1.9187e-02,
#           6.6283e-03, -2.0382e-01,  5.8128e-02, -1.5041e-01,  2.5277e-01]])


# ### Fe_fm_2n
# para_input = torch.tensor([[ 1.0822e-01, -8.1577e-01, -7.6137e-01, -7.6164e-01,  1.5477e+00,
#           1.3290e+00,  1.2679e+00,  3.6680e+00, -1.6224e+00,  1.4893e+00,
#           7.0518e+00,  9.8476e-01, -2.4643e-03,  1.0878e-02, -7.6843e-03,
#           4.0583e-03,  1.3116e-01, -3.9600e-01,  3.5037e-01, -3.6064e-02,
#           2.2978e-01, -1.3694e-01, -1.4395e-01,  2.4991e-01,  2.3926e-03,
#          -6.3093e-02, -6.3717e-02,  3.9274e-02, -3.6370e-03,  3.3078e-02,
#          -2.1436e-02, -1.8970e-01,  6.5875e-01,  2.8095e-01,  1.3150e-01,
#          -2.1243e-01,  6.1594e-02, -1.4754e-02,  1.1348e-01, -5.5040e-02,
#           2.8891e-02,  3.8317e-02]])

# ### Fe_fm_d_5n
# para_input = torch.tensor([[ 8.1256e-02,  3.7057e-01,  2.2687e-01,  5.1696e-01,  7.9303e-02,
#          -7.7855e-01, -1.7011e-01,  3.2638e-01, -4.5020e-02, -2.7956e-01,
#          -2.8774e-01,  4.9632e-01, -1.2401e-02,  1.9734e-01,  8.1611e-01,
#           6.6164e-01,  3.7732e-01,  3.7052e-01, -3.9248e-03, -2.1479e-01,
#           2.0670e-01, -3.1641e-02,  8.6599e-01,  8.8306e-01, -1.5197e+00,
#          -1.7180e+00, -1.6516e+00,  5.3264e-01, -2.4255e-02, -1.5661e-01,
#          -1.7330e-01, -3.2331e-02,  5.8041e-02,  3.0386e-01, -5.6806e-02,
#          -4.4084e-02,  1.5697e-01,  7.7773e-02, -1.8502e-01,  4.1794e-02,
#           3.3377e-02,  1.4405e-01, -1.3740e-01,  6.2312e-01, -4.5875e-01,
#          -2.1227e-01,  3.0886e-01, -1.0603e-01,  7.3478e-01, -5.5677e-01,
#          -1.0088e-02, -1.4967e-01, -1.6839e-01,  2.4405e-01,  8.4805e-01,
#          -2.3499e+00, -2.3478e-02,  2.7390e-01, -1.6009e+00, -2.8153e-01,
#           2.0681e-01, -1.0430e-01, -1.2178e-01,  2.3680e-01, -1.8216e-01,
#           1.7472e-01,  5.6276e-01, -4.1845e-01, -9.8973e-02, -7.1913e-02,
#          -3.4491e-01, -5.7619e-04,  3.9386e-02, -1.7418e-02, -9.9290e-02,
#           6.5773e-02,  3.5979e-02,  6.9112e-02,  7.9551e-02,  3.6154e-03,
#           7.8891e-02, -1.5444e-01,  2.1124e-02,  3.9193e-02,  3.8462e-01,
#          -9.3764e-02, -2.5575e-01,  1.1463e-01, -7.8484e-02, -3.3419e-02,
#          -4.9202e-03,  5.3191e-02,  3.9864e-02,  3.5827e-02, -3.3461e-02,
#          -9.8405e-02,  6.2879e-02, -3.4244e-02, -5.5348e-01, -2.4808e-02,
#           1.1683e+00, -6.6542e-02, -1.1253e-01, -6.7826e-02,  1.0352e+00,
#           6.2760e-02,  1.1950e-01,  5.3548e-02,  8.6141e-02, -5.0882e-02,
#          -9.7631e-02,  6.0814e-03, -7.1269e-03,  1.0699e-01,  1.2575e-01,
#          -1.1029e-01, -4.4404e-02,  1.0459e-01, -1.8350e-02,  4.1688e-02,
#           1.4266e-02, -1.8772e-02,  2.9107e-02,  1.7630e-01,  2.6331e-01,
#          -1.6737e-01,  9.0365e-02, -2.2995e-01,  3.2143e-01, -4.5699e-01,
#          -9.2233e-01, -2.9851e-01,  1.0164e+00,  1.5666e-01,  1.7371e-01,
#           5.3352e-02, -6.1346e-01,  6.9369e-02,  4.9707e-02,  2.0553e-01,
#           6.3998e-01,  8.0468e-03,  3.3798e-02, -9.9636e-02,  1.4645e-02,
#           2.3186e-02,  8.9500e-03,  7.3572e-03, -6.3165e-01,  7.6900e-01,
#          -3.6758e-01, -2.6402e-01,  2.4786e-01,  4.4872e-01,  5.5180e-01,
#          -2.1601e-01,  7.1056e-01, -6.0306e-01,  1.3734e-01, -9.1109e-01,
#           8.7525e-01, -4.4752e-01, -1.6807e+00, -3.2131e-01, -8.7709e-01,
#           2.0451e-01, -6.2118e-02,  3.3276e-02, -3.4559e-02, -2.2932e-02,
#          -2.1546e-02,  6.7143e-02,  7.7217e-03,  9.3798e-03, -1.8422e-02,
#          -1.3481e-02, -1.3683e-02, -6.2009e-03,  3.9470e-02, -1.9269e-02,
#           3.4869e-02,  4.2589e-03,  1.9704e-02, -6.2389e-02, -5.0497e-02,
#           4.2362e-02, -5.2626e-03, -1.7981e-02, -5.3786e-02, -1.8977e+00,
#           5.1574e-03,  6.8011e-02, -1.6439e-02, -1.6125e-01,  3.0555e-01,
#           3.8112e-02, -5.9959e-02,  9.2086e-03, -1.3660e-01,  1.7072e-02]])


threshold = 1e-3
para_input = torch.where(abs(para_input) < threshold, torch.tensor(0.0), para_input)

band.init_calculate_model("/data/home/kongfh/DFTBAI1/example/test_TB/Fe_fm/Fe_fm_d_3n.pkl",
                              para = para_input
                              )
# band.plot_model(band.content['k_vector'],save_path="/home/hp/users/kfh/DFTBAI1/example/test_TB/Fe_fm/calculate_band.png",
#                     select_band=model_index
#                     )

print(para_input.shape)
band.plot_compare(band.content['k_vector'],save_path="/data/home/kongfh/DFTBAI1/example/test_TB/Fe_fm/compare8_19.png",
                  model_index=model_index,band_index=band_index,title="Fe_fm_d_3n")