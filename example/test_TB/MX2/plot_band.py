import os
import sys
file_path = sys.argv[0]
root_path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(file_path))))
sys.path.append(root_path)
sys.path.append(os.path.join(root_path,"module"))
import torch
import numpy as np


from module.physics_property.band.band import Band

band = Band()

band.get_data("/data/home/kongfh/DFTBAI1/example/BAND-total/MnTe2-metal/BAND.dat")
#band.get_data("/home/hp/users/kfh/DFTBAI1/example/test_TB/Si_like/Si_PC/BAND.dat")
print(band.content['k_vector'].shape)
print(band.content["energy"].shape)

band_index = [i for i in range(70,84)]
model_index = [i for i in range(6,30)]

# band.plot_data("/home/hp/users/kfh/DFTBAI1/example/test_TB/MgO/DFT_MgO.png",band_index)

para_input = torch.tensor([[ 8.8870e-02, -1.4146e+00,  1.2450e+00, -3.6168e-01,  6.9505e-01,
          1.0637e+00, -1.4573e-01,  6.2475e-01, -3.1389e+00,  1.8355e+00,
          1.1611e+00, -4.9038e-01, -2.0488e+00, -2.2836e+00,  1.4351e-01,
         -7.5583e-01, -1.4558e-01,  1.5079e+00,  2.2718e+00,  2.5133e+00,
          1.6135e-01, -2.2518e+00, -1.1872e-01,  4.5222e-01, -8.5346e-01,
         -1.0528e-01, -3.9588e-02, -1.5310e-01, -1.5730e+00,  8.6925e-01,
         -1.1493e-01,  1.4983e+00,  9.3925e-01, -3.3736e-01,  2.1305e-01,
          1.3250e+00,  1.0698e+00,  2.5977e-02, -3.6157e-01,  1.7057e+00,
          7.9849e-01,  2.2396e+00,  2.7140e-02, -1.3164e+00,  8.1773e-01,
          3.3374e-01,  5.2271e-01,  4.1800e-01, -2.6968e+00,  1.6201e+00,
         -9.7900e-01, -1.8823e+00,  1.0019e+00, -1.4620e+00, -3.8689e-01,
          4.4669e-01,  7.5323e-02, -6.9522e-01, -1.2486e+00,  2.5906e-01,
         -1.1435e+00,  4.7274e-01, -1.8291e+00,  2.2365e+00,  5.2905e-02,
          2.3637e-01, -6.5146e-02,  4.5366e-02,  1.4729e-02, -9.3629e-02,
         -2.2910e-01, -1.8111e-01, -1.5402e-01,  2.0940e-01, -9.9959e-02,
          9.1475e-02,  2.0730e-01, -1.7990e-01,  1.5587e-02, -2.9228e-01,
         -2.4764e-01, -6.3716e-02, -1.6445e-01, -1.8575e-01, -2.9004e-02,
         -2.1678e-02, -1.3525e-01, -4.8067e-02, -2.0002e-01, -1.6016e-01,
          1.3813e-01,  2.4126e-01, -1.3110e-01,  1.7549e-02,  7.9259e-02,
          1.6106e-03,  1.5765e-01, -2.3034e-01,  6.5840e-02,  4.4702e-02,
         -4.2964e-01, -9.5052e-01, -2.1322e-01,  1.2348e-01,  2.2746e-01,
          1.0557e+00,  1.1776e+00,  9.2272e-01, -4.2532e-01,  8.9702e-01,
          2.0766e-01, -5.4328e-03, -5.6930e-01,  1.3431e+00, -6.7049e-02,
         -5.4714e-01,  3.8067e-01,  1.3591e+00, -4.4657e-01, -3.2258e-01,
         -4.5785e-01, -6.9044e-01,  2.6331e-01,  5.0365e-01, -1.8177e+00,
          1.9729e-02, -1.2743e+00, -2.3465e-01, -3.8946e-01,  6.1031e-01,
          5.9471e-01, -1.0800e+00, -4.1227e-01,  7.4444e-01,  4.3042e-01,
         -1.2649e-01, -3.8879e-02,  5.2239e-01, -1.3985e-02,  1.2987e+00,
          1.6406e-01, -6.8657e-01,  6.5428e-01, -9.4317e-01, -2.8408e-01,
          3.4885e-01,  2.6999e-01, -2.2675e+00, -5.8569e-01,  1.1123e+00,
         -1.6700e+00,  1.8993e-01,  2.4532e-01,  6.6887e-01, -4.0604e-01,
         -1.6205e+00,  6.6559e-01,  8.7570e-01, -5.3276e-02,  4.4709e-02,
          7.2517e-01,  1.4178e-01,  6.6480e-01,  4.3441e-01,  2.3686e-01,
         -6.1408e-01,  5.6459e-01, -1.3614e+00,  7.1953e-02,  4.3900e-01,
         -1.3462e+00, -1.5623e+00,  6.1982e-01,  5.6597e-01,  8.9774e-02,
          8.6374e-01,  1.9014e-01, -1.4663e-01, -8.6850e-01, -1.2296e-02,
          8.0941e-01, -7.8165e-01, -2.4261e-01,  2.8634e-01,  3.0877e-01,
         -4.6700e-01,  4.3004e-01, -1.2501e-01, -5.8436e-01, -4.8513e-01,
         -5.8972e-01,  2.9330e-01,  2.4596e-01, -1.5252e-03, -1.0651e+00,
          5.9516e-01,  2.5600e-01,  2.1120e-01,  1.5058e+00,  1.3889e-01,
          1.5954e-01, -7.6098e-01,  8.0429e-02,  8.1251e-01, -6.3881e-02,
         -7.3098e-01,  3.6487e-01, -4.3151e-01,  2.1850e-01, -5.0448e-02,
         -1.7654e-01, -2.2175e-01, -3.3785e-01, -1.7198e-01, -9.9496e-01,
          1.2082e+00, -3.1643e-01,  2.2874e-01,  4.6948e-01,  9.2690e-01,
          2.7176e-01, -2.4313e-01, -4.3924e-02,  6.1850e-01, -1.2670e-01,
          3.1293e-01, -2.2451e-01,  5.4403e-01, -2.6033e-01, -2.9246e-01,
         -2.6575e-01,  3.6201e-01, -2.8393e-01, -2.0021e-01,  2.3865e-01,
         -4.5993e-01, -6.7693e-01,  2.9407e-01, -7.7201e-02, -3.1117e-01,
          3.6478e-02, -4.8366e-01, -5.7296e-01,  8.1229e-01, -6.3790e-01,
         -3.3480e-01,  2.0067e-01, -1.1074e+00, -1.0139e+00, -2.8212e-01,
          5.3715e-01,  3.2097e-01, -1.1614e+00, -1.5399e-01,  3.2555e-01,
         -5.7220e-01, -5.6778e-01,  5.7357e-02, -4.2727e-01,  9.5437e-01,
         -3.2134e-01, -1.5273e-01,  6.2843e-01,  6.3307e-01, -2.1531e-01,
          1.8485e-01,  1.6574e+00, -1.3277e+00, -1.1274e+00,  1.5312e+00,
         -1.3936e+00,  7.1438e-02,  5.9214e-01,  5.2022e-01, -2.4641e-01,
         -2.3637e+00,  9.2346e-01,  1.1902e+00,  7.0709e-02, -2.1133e-01,
          1.0381e+00, -8.5605e-04,  3.9675e-01,  9.3979e-01,  7.3182e-01,
         -9.5454e-01,  5.6339e-01, -8.5451e-01,  4.2392e-02,  7.7571e-01,
         -9.7702e-01, -2.1742e+00,  1.1728e-01,  6.3841e-03,  4.0539e-02,
         -2.3309e-01,  1.2856e-01,  6.6871e-03,  2.6814e-02,  1.5754e-02,
          1.9865e-01,  2.8903e-01, -9.4051e-02,  3.4936e-02, -1.2167e-01,
          6.5787e-02, -9.5742e-03,  1.2422e-01,  7.6035e-02,  1.3377e-01,
         -2.5861e-02,  5.3651e-02, -9.2174e-02,  2.4565e-01, -3.5093e-02,
          2.9314e-01, -2.5735e-01,  5.0797e-02,  3.5992e-02,  4.0359e-02,
          1.7106e-02,  1.3805e-01, -2.6315e-02,  2.2035e-03, -5.7663e-02,
          4.3079e-02, -9.2450e-02, -4.6196e-02,  4.3901e-01,  6.4826e-02,
          9.5712e-02, -1.6654e-01, -1.5904e-01, -1.8465e-01, -4.8861e-02,
         -1.2155e-01,  1.3194e-01, -2.3312e-01,  1.2220e-01, -2.0405e-01,
          9.2057e-02, -2.7471e-02, -7.6761e-03, -1.0257e-01, -3.1150e-02,
         -4.5054e-02, -7.4420e-02, -3.0002e-01,  1.0738e-01,  3.7970e-02,
         -1.1518e-01, -4.8527e-02, -1.4240e-01, -1.8521e-01,  6.7923e-02,
          5.5158e-02,  1.8718e-01,  4.8861e-02, -5.0715e-02, -1.4402e-01,
         -1.3633e-01,  3.3480e-01,  4.2893e-02,  4.3541e-02,  7.2650e-01,
         -5.0057e-01,  1.0140e+00,  1.0685e+00, -1.5594e+00,  3.3266e-01,
          1.0796e+00, -1.8888e-01,  4.2794e-01,  2.6874e-01, -1.5201e-01,
          1.1908e+00, -6.3094e-01,  3.0502e-01, -4.1594e-02,  6.4884e-01,
          7.5151e-01,  2.3529e-01,  5.8124e-01, -3.8684e-01,  9.4172e-01,
         -4.3029e-01,  3.5715e-01, -8.8308e-01, -2.1569e-01, -1.3448e+00,
          8.6961e-01, -1.3711e+00,  1.8286e+00,  1.2875e+00,  1.4617e-01,
         -9.3264e-01, -4.1538e-01, -5.3546e-02, -3.4797e-01,  1.5796e+00,
          2.8551e-01, -1.3420e+00, -1.1198e+00, -4.8059e-01, -1.0278e+00,
         -4.0866e-01, -2.9134e-01,  6.6554e-01,  7.6886e-01,  3.5290e-01,
          1.3655e+00,  2.3419e-01,  9.8240e-01,  1.2294e+00, -1.2198e-01,
         -5.3463e-02, -3.8859e-01, -3.9702e-01, -3.9636e-01,  9.9143e-01,
          1.5649e-01, -9.8484e-01,  8.6844e-01,  7.7729e-01,  2.4370e-01,
         -3.8318e-01, -7.9695e-02, -7.1178e-02, -7.5747e-01,  3.7624e-01,
         -1.3164e-01,  3.5011e-01, -2.7580e-01,  2.2033e-01, -1.5192e-01,
         -1.0872e+00,  2.1970e-01,  1.1786e+00, -4.1648e-01, -8.7646e-01,
         -9.4796e-02, -7.5403e-02, -9.8590e-01, -8.2909e-01, -3.7449e-01,
         -3.1827e-01,  3.0245e-01,  1.1066e-01, -1.0312e+00,  5.9184e-01,
         -3.0195e-01, -4.4757e-01, -1.0404e+00,  4.5300e-01,  1.0194e-01,
         -3.3176e-01, -1.7613e+00, -6.0608e-01,  4.5567e-01, -1.2549e+00,
          2.6092e-01,  2.7034e-01,  3.2757e-01, -5.3523e-01, -2.3914e-01,
         -7.1594e-01, -1.6863e-01,  5.5494e-01, -2.4612e-01,  2.1387e-01,
         -1.4020e-01,  5.5769e-01, -6.4301e-02, -3.7740e-01, -4.6045e-01,
         -1.8154e-02,  4.1764e-01,  3.2782e-01,  2.5566e-01, -1.1956e-01,
         -2.6460e-01,  1.4204e-01, -3.2999e-01, -2.7846e-02,  6.9667e-01,
          8.4968e-01, -9.7300e-01,  2.9906e-01,  1.4024e+00,  8.1773e-01,
          6.4687e-01, -1.2637e-01, -1.3684e-01,  8.2589e-03,  1.2778e-01,
         -1.3821e-02, -1.2054e-01, -8.4959e-02,  5.6308e-02,  2.4665e-01,
         -3.4352e-02,  1.8392e-01, -1.3177e-01,  4.8328e-02,  9.8048e-02,
          1.9177e-02,  3.6302e-02,  6.0886e-03, -1.1175e-01, -1.1361e-01,
          1.9450e-01,  1.2636e-01, -1.5948e-01, -1.9028e-01,  2.7859e-01,
          6.9732e-02,  4.7642e-02,  5.2720e-02, -1.0584e-01, -1.0596e-01,
          1.0552e-01, -2.6802e-01, -8.1736e-02, -2.5778e-01,  1.6669e-01,
         -4.2123e-02, -3.7606e-02,  1.8327e-01]])
para_input = torch.tensor(
    [[ 1.5197e+00, -1.7604e+00, -3.6427e-01, -1.2348e+00, -7.3295e-02,
          1.1720e-01,  8.1609e-01,  1.5026e+00,  1.1036e+00,  1.8281e+00,
         -2.5125e-02, -4.1631e-01,  4.2383e-01,  1.2442e-01, -1.9625e+00,
          2.5890e+00, -1.7704e+00, -3.2022e-01, -8.5053e-02,  2.0900e+00,
         -3.8666e-01,  7.9899e-01, -2.7294e-01,  1.6058e+00, -9.7723e-01,
          1.0479e+00,  1.8274e+00,  1.0983e+00, -1.4105e-01,  5.8705e-03,
         -4.0941e-01, -8.0552e-01,  7.0373e-01,  2.1665e+00, -1.1799e-02,
         -5.4192e-02,  4.0397e-01,  3.6578e-01,  1.0075e+00,  9.5999e-01,
         -3.7159e-01,  1.8361e+00,  9.1253e-01,  1.0158e+00, -6.3736e-01,
          1.2570e-01,  5.3431e-01, -9.4370e-01,  8.3054e-01,  4.0370e-01,
         -7.3745e-01,  4.0655e-01, -1.0912e+00,  3.9074e-01, -1.9340e-01,
         -1.5015e+00, -6.2658e-01,  4.1583e-01,  2.5630e+00, -2.5509e-01,
          3.3385e-01,  3.1338e+00,  9.0402e-01,  3.3070e-02,  6.1505e-01,
          1.1847e+00, -4.7513e-01, -5.3326e-01,  9.6502e-01, -2.2243e-01,
          6.2832e-01,  1.6362e-01,  1.5690e+00, -8.8298e-01,  1.0609e+00,
          1.7610e+00, -1.4660e+00,  6.4725e-01,  1.0878e+00,  5.0383e-01,
         -7.5618e-01,  9.8392e-02, -5.4729e-01, -1.3977e+00,  1.6207e-01,
         -3.3803e-01,  1.3100e-02, -6.7648e-01,  1.2684e+00,  6.8311e-01,
         -8.9694e-01,  1.2084e+00,  3.2097e+00, -4.7404e-01, -1.6226e+00,
          3.1645e-01, -1.5308e+00, -1.9597e-01,  6.0838e-01, -4.0673e-01,
          7.9869e-01,  1.3361e-01, -1.0123e-01, -6.1253e-02, -6.1745e-02,
         -1.3312e-01,  2.6780e-01,  3.7251e-01, -1.9707e-02, -4.0427e-01,
          2.5544e-01,  2.8188e-01, -4.0624e-02, -3.2877e-01, -2.7778e-01,
          3.7980e-02,  4.3627e-01, -2.1832e-03, -2.6944e-01,  6.4710e-02,
          4.0293e-01, -2.0126e-01,  6.1104e-02,  1.9976e-01,  3.0101e-01,
          1.1034e-04, -5.6418e-02,  4.2463e-01, -2.4548e-01, -1.9041e-01,
          1.7366e-01,  3.7186e-02,  2.2085e-01, -4.5150e-01,  5.1569e-03,
          5.1495e-01, -4.7631e-01,  8.4941e-01,  7.1204e-01,  3.9854e-01,
         -1.8331e+00,  1.6470e+00,  2.4647e-01,  1.8811e+00,  3.4508e-01,
         -1.7506e-01, -2.2827e-01,  1.2514e+00, -9.4175e-01,  1.4710e+00,
          1.0537e+00,  4.9048e-01,  1.3728e+00, -3.2474e-01, -3.6744e-01,
          5.4594e-01,  1.4287e+00,  5.0248e-01, -9.5845e-01, -1.5697e+00,
          6.7065e-01,  2.0424e-01,  9.6237e-01,  3.2460e-01, -2.5325e-01,
         -7.6764e-01, -8.5360e-01, -5.4599e-02,  7.0333e-01,  1.0287e-01,
         -1.2237e+00, -1.2008e+00, -3.5024e-01, -3.3482e-01, -1.1057e+00,
          9.6409e-01,  2.6143e-01,  5.9407e-01, -1.0815e+00, -1.5983e+00,
          8.3514e-01,  4.4604e-02,  2.2774e-01,  3.8437e-01, -4.4168e-01,
          6.0310e-02, -6.1805e-01, -1.5915e-01, -3.4297e-01,  1.5470e-01,
          2.9723e-01,  6.7461e-01, -1.4321e-01,  2.3092e-01,  3.7492e-01,
          1.1718e+00,  2.7475e-01,  1.1384e-01,  1.0087e+00,  5.4297e-02,
          1.4953e-01, -2.8120e-01, -6.6287e-01,  1.2432e+00,  8.7183e-02,
         -5.9697e-01,  2.8922e-01, -6.2891e-01,  8.0048e-02, -4.6743e-01,
         -3.1131e-01, -1.3312e-01, -1.4614e-01, -1.1331e+00, -8.4070e-01,
          1.5073e-02,  2.4991e-01,  5.7027e-02, -4.4789e-01,  2.4486e-01,
         -6.4838e-02, -5.6734e-01, -2.5109e-01,  1.5039e-01, -1.1945e-01,
          3.9869e-01,  2.9625e-02, -1.1521e-01, -9.9264e-01,  1.7725e-01,
          5.0390e-01,  3.9393e-02,  1.8614e+00, -4.0155e-01,  5.8428e-01,
          4.3608e-01,  6.3221e-01, -1.4987e+00,  9.4852e-01, -6.5912e-01,
          1.6484e+00, -6.5539e-02,  2.1336e-01, -1.5264e+00,  1.8791e+00,
         -2.2782e+00, -1.1240e+00,  7.1742e-01, -6.5456e-01, -6.8592e-01,
         -1.6554e+00, -4.7994e-01, -6.4481e-01, -2.0376e-01,  1.3544e-01,
          1.8858e+00,  2.1404e-01, -6.9968e-01, -1.3494e-01, -2.9438e-01,
         -1.0199e+00, -2.0292e-01,  1.5569e-01, -1.1383e+00,  3.5684e-02,
         -8.9675e-01, -1.9400e-01,  3.5697e-02, -1.0316e+00, -1.4482e+00,
          7.5068e-01, -5.5743e-02, -3.9363e-01,  1.5074e-01,  6.1804e-01,
          2.2293e+00, -8.3532e-01, -5.9963e-01,  7.9456e-01, -2.9166e-01,
         -6.9858e-02, -7.1285e-01, -9.3825e-01, -3.9176e-01,  5.4929e-01,
         -8.3933e-01,  5.2250e-01, -9.0567e-01, -2.5280e-01, -2.5682e-01,
          1.1114e+00,  1.9727e-01,  4.8184e-01, -1.6569e+00,  5.6836e-01,
         -5.1271e-01, -1.1271e+00, -2.3589e-01,  3.2867e-01,  1.5909e+00,
         -1.1008e+00, -4.3225e-01,  6.5670e-01,  6.6088e-01,  7.0750e-01,
          7.5703e-01,  1.5510e+00,  5.2828e-01, -6.0592e-01,  1.5837e+00,
          1.6817e-01, -5.4866e-01,  5.6378e-01, -8.3726e-01,  2.8239e-01,
         -9.9920e-01, -1.3913e+00, -2.5595e-01, -8.5662e-01, -6.1551e-01,
          1.7274e-01, -3.8168e-02,  2.6452e+00, -8.7835e-01,  8.4049e-01,
          1.4181e+00, -1.2469e+00,  6.4328e-02, -4.7397e-01, -1.2837e-01,
         -1.5202e+00, -6.6282e-01,  5.5448e-01, -2.3501e-01, -1.9102e-01,
          5.5780e-01, -1.0183e+00,  6.2632e-01,  7.7453e-01,  1.3865e+00,
          6.3503e-01,  9.9593e-01,  1.6888e-01, -1.9936e-01, -1.8085e-01,
         -3.4368e-01,  3.8342e-01, -2.9523e-01, -7.5849e-01,  3.9611e-02,
          3.7799e-01,  2.0491e-01, -3.0844e-01,  8.2940e-01,  3.7837e-01,
         -1.1856e-01,  5.0327e-01,  1.4275e+00,  7.1522e-02, -4.2118e-01,
         -6.4961e-01, -7.1630e-02,  3.0806e-01,  3.2593e-01, -8.2542e-01,
          1.0010e+00, -3.5696e-01, -8.8667e-01,  9.9977e-02,  1.7891e-01,
          2.1991e+00, -1.1000e+00,  6.9826e-01,  3.0379e-01, -6.4211e-01,
         -9.2901e-02,  1.0717e-01, -1.4010e-01, -1.7187e-01, -5.1186e-02,
         -2.7815e-01, -3.1193e-02, -1.1153e-01, -2.8021e-01, -1.3501e-01,
          9.7031e-02,  4.8677e-02, -1.1208e-01,  5.4152e-02,  5.3827e-03,
         -8.9563e-02, -1.8977e-01,  3.9103e-01,  1.8333e-01, -1.1823e-01,
          9.4509e-02,  3.9238e-01,  1.0958e-01,  2.7688e-01, -5.4317e-02,
          7.6150e-02, -1.7223e-01,  5.6695e-03,  1.7027e-01,  4.6318e-02,
          3.8055e-03, -1.6900e-01, -1.2361e-01, -4.1786e-01,  2.7965e-02,
          2.4486e-01, -6.5993e-02,  1.2523e-01,  2.6511e-02,  4.1474e-01,
         -2.9408e-01,  3.1977e-01, -9.4897e-02,  1.4731e-01,  6.6875e-02,
          1.2575e-02, -4.5030e-02, -1.9738e-01, -1.1793e-01, -1.7471e-02,
         -9.4558e-02,  8.0336e-02,  6.4711e-02,  1.9106e-01,  7.2276e-02,
         -1.1611e-01, -7.5729e-04,  8.5798e-02,  2.0465e-01, -8.4646e-02,
         -4.6837e-01,  1.1838e-02,  1.2883e-01, -4.1913e-01, -1.9832e-01,
         -2.6148e-01,  2.9704e-02,  1.4428e-01,  8.5006e-02, -4.9464e-01,
         -7.8519e-02,  2.7590e-01,  1.0328e-01,  1.3606e+00,  4.7946e-01,
          2.0358e-01,  6.6253e-01,  1.2984e-01, -1.4460e+00, -1.0629e+00,
         -7.8793e-01,  3.3715e-01,  8.8125e-01,  6.3676e-01,  7.4761e-01,
          1.8960e-01, -7.1884e-02, -1.1270e+00, -1.2240e+00, -2.1800e-01,
         -4.0136e-01,  4.2434e-02, -1.2970e+00, -3.5883e-01,  1.4017e-01,
         -9.9128e-01,  3.3029e-01,  1.6318e-01, -4.2206e-01,  4.9536e-01,
          1.7110e-01, -3.9952e-02, -8.9919e-01,  3.5721e-01,  3.7358e-01,
         -8.1977e-01, -7.3412e-01,  1.0649e+00, -1.4425e+00, -2.5803e+00,
          1.1843e+00,  9.8257e-01,  3.7312e-01, -8.0258e-02,  4.4677e-01,
         -1.8655e+00, -4.8503e-01, -2.2062e-01,  2.9658e-01, -7.8188e-01,
          1.4237e-01,  9.6015e-01,  4.5507e-01, -2.7477e-01,  1.1251e+00,
          1.6497e+00,  5.6440e-01, -1.3944e+00, -7.4882e-01,  4.2154e-01,
          4.4328e-01,  7.4821e-01, -1.6741e-01, -5.5204e-01, -3.7373e-01,
          9.3024e-01, -7.4054e-01, -5.0994e-01, -4.2563e-01,  1.0342e-01,
         -2.4547e-01, -4.6570e-01,  1.1311e+00, -3.9843e-01, -1.4520e+00,
         -4.6716e-02, -4.2642e-01,  3.6559e-01,  6.9734e-01, -2.5108e-01,
          8.1091e-01,  1.6919e+00, -1.4707e+00, -6.3012e-01, -9.1686e-01,
          3.5043e-01,  1.2083e+00,  6.2550e-01,  2.3628e-01,  8.0549e-01,
          1.0759e+00,  5.3598e-01,  1.1503e-01, -5.8982e-01,  1.1284e+00,
          6.4632e-01, -2.5822e-01, -4.1780e-01, -1.4202e+00, -9.8187e-01,
         -1.4437e-01, -5.7940e-02, -7.9952e-02, -1.3527e+00,  2.6320e-01,
          6.6610e-01,  1.5075e-01,  5.5606e-01, -2.3392e-01, -1.0950e+00,
          7.2371e-01, -6.6396e-02,  6.1413e-01, -5.0700e-01, -1.9225e+00,
          4.8021e-02, -2.5073e+00,  3.3561e-01,  1.5688e-01,  4.6943e-01,
          3.5022e-01,  6.0259e-01, -7.2421e-01, -2.0992e-01,  1.2084e+00,
          2.5090e-01,  5.6007e-01,  7.6107e-02,  1.3059e+00,  1.5314e-01,
         -1.6069e+00,  5.6344e-02,  7.9082e-01,  4.0095e-02,  1.8873e+00,
          1.9611e+00,  1.0061e+00, -1.3982e+00,  1.8287e-01,  1.5101e+00,
          3.0768e-01, -9.8139e-02, -5.5824e-01, -2.0830e-01, -5.8744e-01,
          2.8904e-01, -3.2816e-01, -1.2478e-01,  8.3125e-01, -1.3307e+00,
          5.9398e-01,  2.8360e-01, -2.2911e-01,  5.7588e-01,  1.1186e+00,
         -1.2311e-01,  1.5358e+00,  1.7695e+00,  4.9372e-01, -6.4741e-01,
         -4.7050e-01, -8.7985e-02, -3.4045e-01, -3.7256e-01, -2.3996e-01,
          2.1184e-01,  6.0742e-01, -2.5944e-01,  5.7403e-01, -1.2061e+00,
         -1.1463e+00, -4.6337e-01, -5.3046e-02,  7.3705e-01,  7.0589e-01,
          9.1278e-02,  1.9488e-02, -3.9466e-01,  9.8196e-02,  7.8690e-02,
          8.3504e-01, -2.7435e-01,  4.1288e-01,  5.8170e-01, -5.9330e-01,
         -1.8264e+00,  1.4407e+00,  2.7675e-01,  1.2544e-01,  1.3319e+00,
         -9.7760e-01, -4.7446e-01,  3.4064e-01, -1.1036e+00,  3.0318e-01,
         -2.0705e-01, -7.9484e-01, -9.8559e-02, -3.6850e-01,  7.8896e-01,
         -2.2470e-01, -9.0965e-01, -5.1280e-01,  2.5862e-01, -1.0488e-02,
         -9.5362e-02,  5.4820e-02,  1.0828e-01,  9.3392e-02,  1.0634e-02,
          4.9405e-02, -3.3722e-01,  2.7194e-02, -1.7737e-01, -4.4536e-01,
          7.7976e-02, -2.0510e-01, -8.5444e-02, -1.4542e-01, -8.8238e-02,
          1.0081e-02,  3.9546e-01, -9.2604e-02, -2.0308e-01,  1.3018e-02,
          2.4688e-01,  3.3855e-02,  7.0000e-02, -2.1541e-01, -1.4541e-01,
         -2.7817e-01,  1.7499e-01,  9.8378e-02, -6.4503e-02, -2.4377e-01,
         -3.8210e-01,  1.2685e-01,  1.2731e-01, -2.6229e-01]]
)

para_input = torch.tensor([[ 1.5197e+00, -1.7604e+00, -3.6427e-01, -1.2348e+00, -7.3295e-02,
          1.1720e-01,  8.1609e-01,  1.5026e+00,  1.1036e+00,  1.8281e+00,
         -2.5125e-02, -4.1631e-01,  4.2383e-01,  1.2442e-01, -1.9625e+00,
          2.5890e+00, -1.7704e+00, -3.2022e-01, -8.5053e-02,  2.0900e+00,
         -3.8666e-01,  7.9899e-01, -2.7294e-01,  1.6058e+00, -9.7723e-01,
          1.0479e+00,  1.8274e+00,  1.0983e+00, -1.4105e-01,  5.8705e-03,
         -4.0941e-01, -8.0552e-01,  7.0373e-01,  2.1665e+00, -1.1799e-02,
         -5.4192e-02,  4.0397e-01,  3.6578e-01,  1.0075e+00,  9.5999e-01,
         -3.7159e-01,  1.8361e+00,  9.1253e-01,  1.0158e+00, -6.3736e-01,
          1.2570e-01,  5.3431e-01, -9.4370e-01,  8.3054e-01,  4.0370e-01,
         -7.3745e-01,  4.0655e-01, -1.0912e+00,  3.9074e-01, -1.9340e-01,
         -1.5015e+00, -6.2658e-01,  4.1583e-01,  2.5630e+00, -2.5509e-01,
          3.3385e-01,  3.1338e+00,  9.0402e-01,  3.3070e-02,  6.1505e-01,
          1.1847e+00, -4.7513e-01, -5.3326e-01,  9.6502e-01, -2.2243e-01,
          6.2832e-01,  1.6362e-01,  1.5690e+00, -8.8298e-01,  1.0609e+00,
          1.7610e+00, -1.4660e+00,  6.4725e-01,  1.0878e+00,  5.0383e-01,
         -7.5618e-01,  9.8392e-02, -5.4729e-01, -1.3977e+00,  1.6207e-01,
         -3.3803e-01,  1.3100e-02, -6.7648e-01,  1.2684e+00,  6.8311e-01,
         -8.9694e-01,  1.2084e+00,  3.2097e+00, -4.7404e-01, -1.6226e+00,
          3.1645e-01, -1.5308e+00, -1.9597e-01,  6.0838e-01, -4.0673e-01,
          7.9869e-01,  1.3361e-01, -1.0123e-01, -6.1253e-02, -6.1745e-02,
         -1.3312e-01,  2.6780e-01,  3.7251e-01, -1.9707e-02, -4.0427e-01,
          2.5544e-01,  2.8188e-01, -4.0624e-02, -3.2877e-01, -2.7778e-01,
          3.7980e-02,  4.3627e-01, -2.1832e-03, -2.6944e-01,  6.4710e-02,
          4.0293e-01, -2.0126e-01,  6.1104e-02,  1.9976e-01,  3.0101e-01,
          1.1034e-04, -5.6418e-02,  4.2463e-01, -2.4548e-01, -1.9041e-01,
          1.7366e-01,  3.7186e-02,  2.2085e-01, -4.5150e-01,  5.1569e-03,
          5.1495e-01, -4.7631e-01,  8.4941e-01,  7.1204e-01,  3.9854e-01,
         -1.8331e+00,  1.6470e+00,  2.4647e-01,  1.8811e+00,  3.4508e-01,
         -1.7506e-01, -2.2827e-01,  1.2514e+00, -9.4175e-01,  1.4710e+00,
          1.0537e+00,  4.9048e-01,  1.3728e+00, -3.2474e-01, -3.6744e-01,
          5.4594e-01,  1.4287e+00,  5.0248e-01, -9.5845e-01, -1.5697e+00,
          6.7065e-01,  2.0424e-01,  9.6237e-01,  3.2460e-01, -2.5325e-01,
         -7.6764e-01, -8.5360e-01, -5.4599e-02,  7.0333e-01,  1.0287e-01,
         -1.2237e+00, -1.2008e+00, -3.5024e-01, -3.3482e-01, -1.1057e+00,
          9.6409e-01,  2.6143e-01,  5.9407e-01, -1.0815e+00, -1.5983e+00,
          8.3514e-01,  4.4604e-02,  2.2774e-01,  3.8437e-01, -4.4168e-01,
          6.0310e-02, -6.1805e-01, -1.5915e-01, -3.4297e-01,  1.5470e-01,
          2.9723e-01,  6.7461e-01, -1.4321e-01,  2.3092e-01,  3.7492e-01,
          1.1718e+00,  2.7475e-01,  1.1384e-01,  1.0087e+00,  5.4297e-02,
          1.4953e-01, -2.8120e-01, -6.6287e-01,  1.2432e+00,  8.7183e-02,
         -5.9697e-01,  2.8922e-01, -6.2891e-01,  8.0048e-02, -4.6743e-01,
         -3.1131e-01, -1.3312e-01, -1.4614e-01, -1.1331e+00, -8.4070e-01,
          1.5073e-02,  2.4991e-01,  5.7027e-02, -4.4789e-01,  2.4486e-01,
         -6.4838e-02, -5.6734e-01, -2.5109e-01,  1.5039e-01, -1.1945e-01,
          3.9869e-01,  2.9625e-02, -1.1521e-01, -9.9264e-01,  1.7725e-01,
          5.0390e-01,  3.9393e-02,  1.8614e+00, -4.0155e-01,  5.8428e-01,
          4.3608e-01,  6.3221e-01, -1.4987e+00,  9.4852e-01, -6.5912e-01,
          1.6484e+00, -6.5539e-02,  2.1336e-01, -1.5264e+00,  1.8791e+00,
         -2.2782e+00, -1.1240e+00,  7.1742e-01, -6.5456e-01, -6.8592e-01,
         -1.6554e+00, -4.7994e-01, -6.4481e-01, -2.0376e-01,  1.3544e-01,
          1.8858e+00,  2.1404e-01, -6.9968e-01, -1.3494e-01, -2.9438e-01,
         -1.0199e+00, -2.0292e-01,  1.5569e-01, -1.1383e+00,  3.5684e-02,
         -8.9675e-01, -1.9400e-01,  3.5697e-02, -1.0316e+00, -1.4482e+00,
          7.5068e-01, -5.5743e-02, -3.9363e-01,  1.5074e-01,  6.1804e-01,
          2.2293e+00, -8.3532e-01, -5.9963e-01,  7.9456e-01, -2.9166e-01,
         -6.9858e-02, -7.1285e-01, -9.3825e-01, -3.9176e-01,  5.4929e-01,
         -8.3933e-01,  5.2250e-01, -9.0567e-01, -2.5280e-01, -2.5682e-01,
          1.1114e+00,  1.9727e-01,  4.8184e-01, -1.6569e+00,  5.6836e-01,
         -5.1271e-01, -1.1271e+00, -2.3589e-01,  3.2867e-01,  1.5909e+00,
         -1.1008e+00, -4.3225e-01,  6.5670e-01,  6.6088e-01,  7.0750e-01,
          7.5703e-01,  1.5510e+00,  5.2828e-01, -6.0592e-01,  1.5837e+00,
          1.6817e-01, -5.4866e-01,  5.6378e-01, -8.3726e-01,  2.8239e-01,
         -9.9920e-01, -1.3913e+00, -2.5595e-01, -8.5662e-01, -6.1551e-01,
          1.7274e-01, -3.8168e-02,  2.6452e+00, -8.7835e-01,  8.4049e-01,
          1.4181e+00, -1.2469e+00,  6.4328e-02, -4.7397e-01, -1.2837e-01,
         -1.5202e+00, -6.6282e-01,  5.5448e-01, -2.3501e-01, -1.9102e-01,
          5.5780e-01, -1.0183e+00,  6.2632e-01,  7.7453e-01,  1.3865e+00,
          6.3503e-01,  9.9593e-01,  1.6888e-01, -1.9936e-01, -1.8085e-01,
         -3.4368e-01,  3.8342e-01, -2.9523e-01, -7.5849e-01,  3.9611e-02,
          3.7799e-01,  2.0491e-01, -3.0844e-01,  8.2940e-01,  3.7837e-01,
         -1.1856e-01,  5.0327e-01,  1.4275e+00,  7.1522e-02, -4.2118e-01,
         -6.4961e-01, -7.1630e-02,  3.0806e-01,  3.2593e-01, -8.2542e-01,
          1.0010e+00, -3.5696e-01, -8.8667e-01,  9.9977e-02,  1.7891e-01,
          2.1991e+00, -1.1000e+00,  6.9826e-01,  3.0379e-01, -6.4211e-01,
         -9.2901e-02,  1.0717e-01, -1.4010e-01, -1.7187e-01, -5.1186e-02,
         -2.7815e-01, -3.1193e-02, -1.1153e-01, -2.8021e-01, -1.3501e-01,
          9.7031e-02,  4.8677e-02, -1.1208e-01,  5.4152e-02,  5.3827e-03,
         -8.9563e-02, -1.8977e-01,  3.9103e-01,  1.8333e-01, -1.1823e-01,
          9.4509e-02,  3.9238e-01,  1.0958e-01,  2.7688e-01, -5.4317e-02,
          7.6150e-02, -1.7223e-01,  5.6695e-03,  1.7027e-01,  4.6318e-02,
          3.8055e-03, -1.6900e-01, -1.2361e-01, -4.1786e-01,  2.7965e-02,
          2.4486e-01, -6.5993e-02,  1.2523e-01,  2.6511e-02,  4.1474e-01,
         -2.9408e-01,  3.1977e-01, -9.4897e-02,  1.4731e-01,  6.6875e-02,
          1.2575e-02, -4.5030e-02, -1.9738e-01, -1.1793e-01, -1.7471e-02,
         -9.4558e-02,  8.0336e-02,  6.4711e-02,  1.9106e-01,  7.2276e-02,
         -1.1611e-01, -7.5729e-04,  8.5798e-02,  2.0465e-01, -8.4646e-02,
         -4.6837e-01,  1.1838e-02,  1.2883e-01, -4.1913e-01, -1.9832e-01,
         -2.6148e-01,  2.9704e-02,  1.4428e-01,  8.5006e-02, -4.9464e-01,
         -7.8519e-02,  2.7590e-01,  1.0328e-01,  1.3606e+00,  4.7946e-01,
          2.0358e-01,  6.6253e-01,  1.2984e-01, -1.4460e+00, -1.0629e+00,
         -7.8793e-01,  3.3715e-01,  8.8125e-01,  6.3676e-01,  7.4761e-01,
          1.8960e-01, -7.1884e-02, -1.1270e+00, -1.2240e+00, -2.1800e-01,
         -4.0136e-01,  4.2434e-02, -1.2970e+00, -3.5883e-01,  1.4017e-01,
         -9.9128e-01,  3.3029e-01,  1.6318e-01, -4.2206e-01,  4.9536e-01,
          1.7110e-01, -3.9952e-02, -8.9919e-01,  3.5721e-01,  3.7358e-01,
         -8.1977e-01, -7.3412e-01,  1.0649e+00, -1.4425e+00, -2.5803e+00,
          1.1843e+00,  9.8257e-01,  3.7312e-01, -8.0258e-02,  4.4677e-01,
         -1.8655e+00, -4.8503e-01, -2.2062e-01,  2.9658e-01, -7.8188e-01,
          1.4237e-01,  9.6015e-01,  4.5507e-01, -2.7477e-01,  1.1251e+00,
          1.6497e+00,  5.6440e-01, -1.3944e+00, -7.4882e-01,  4.2154e-01,
          4.4328e-01,  7.4821e-01, -1.6741e-01, -5.5204e-01, -3.7373e-01,
          9.3024e-01, -7.4054e-01, -5.0994e-01, -4.2563e-01,  1.0342e-01,
         -2.4547e-01, -4.6570e-01,  1.1311e+00, -3.9843e-01, -1.4520e+00,
         -4.6716e-02, -4.2642e-01,  3.6559e-01,  6.9734e-01, -2.5108e-01,
          8.1091e-01,  1.6919e+00, -1.4707e+00, -6.3012e-01, -9.1686e-01,
          3.5043e-01,  1.2083e+00,  6.2550e-01,  2.3628e-01,  8.0549e-01,
          1.0759e+00,  5.3598e-01,  1.1503e-01, -5.8982e-01,  1.1284e+00,
          6.4632e-01, -2.5822e-01, -4.1780e-01, -1.4202e+00, -9.8187e-01,
         -1.4437e-01, -5.7940e-02, -7.9952e-02, -1.3527e+00,  2.6320e-01,
          6.6610e-01,  1.5075e-01,  5.5606e-01, -2.3392e-01, -1.0950e+00,
          7.2371e-01, -6.6396e-02,  6.1413e-01, -5.0700e-01, -1.9225e+00,
          4.8021e-02, -2.5073e+00,  3.3561e-01,  1.5688e-01,  4.6943e-01,
          3.5022e-01,  6.0259e-01, -7.2421e-01, -2.0992e-01,  1.2084e+00,
          2.5090e-01,  5.6007e-01,  7.6107e-02,  1.3059e+00,  1.5314e-01,
         -1.6069e+00,  5.6344e-02,  7.9082e-01,  4.0095e-02,  1.8873e+00,
          1.9611e+00,  1.0061e+00, -1.3982e+00,  1.8287e-01,  1.5101e+00,
          3.0768e-01, -9.8139e-02, -5.5824e-01, -2.0830e-01, -5.8744e-01,
          2.8904e-01, -3.2816e-01, -1.2478e-01,  8.3125e-01, -1.3307e+00,
          5.9398e-01,  2.8360e-01, -2.2911e-01,  5.7588e-01,  1.1186e+00,
         -1.2311e-01,  1.5358e+00,  1.7695e+00,  4.9372e-01, -6.4741e-01,
         -4.7050e-01, -8.7985e-02, -3.4045e-01, -3.7256e-01, -2.3996e-01,
          2.1184e-01,  6.0742e-01, -2.5944e-01,  5.7403e-01, -1.2061e+00,
         -1.1463e+00, -4.6337e-01, -5.3046e-02,  7.3705e-01,  7.0589e-01,
          9.1278e-02,  1.9488e-02, -3.9466e-01,  9.8196e-02,  7.8690e-02,
          8.3504e-01, -2.7435e-01,  4.1288e-01,  5.8170e-01, -5.9330e-01,
         -1.8264e+00,  1.4407e+00,  2.7675e-01,  1.2544e-01,  1.3319e+00,
         -9.7760e-01, -4.7446e-01,  3.4064e-01, -1.1036e+00,  3.0318e-01,
         -2.0705e-01, -7.9484e-01, -9.8559e-02, -3.6850e-01,  7.8896e-01,
         -2.2470e-01, -9.0965e-01, -5.1280e-01,  2.5862e-01, -1.0488e-02,
         -9.5362e-02,  5.4820e-02,  1.0828e-01,  9.3392e-02,  1.0634e-02,
          4.9405e-02, -3.3722e-01,  2.7194e-02, -1.7737e-01, -4.4536e-01,
          7.7976e-02, -2.0510e-01, -8.5444e-02, -1.4542e-01, -8.8238e-02,
          1.0081e-02,  3.9546e-01, -9.2604e-02, -2.0308e-01,  1.3018e-02,
          2.4688e-01,  3.3855e-02,  7.0000e-02, -2.1541e-01, -1.4541e-01,
         -2.7817e-01,  1.7499e-01,  9.8378e-02, -6.4503e-02, -2.4377e-01,
         -3.8210e-01,  1.2685e-01,  1.2731e-01, -2.6229e-01]])
threshold = 1e-2
para_input = torch.where(abs(para_input) < threshold, torch.tensor(0.0), para_input)

band.init_calculate_model("/data/home/kongfh/DFTBAI1/example/test_TB/MX2/MX2.pkl",
                              para = para_input
                              )
band.plot_model(band.content['k_vector'],save_path="/data/home/kongfh/DFTBAI1/example/test_TB/MX2/calculate_band.png",
                    select_band=model_index
                    )

print(para_input.shape)
band.plot_compare(band.content['k_vector'],save_path="/data/home/kongfh/DFTBAI1/example/test_TB/MX2/compare.png",
                  model_index=model_index,band_index=band_index,title="MnTe2")


