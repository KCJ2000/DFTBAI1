import os
import sys
file_path = sys.argv[0]
root_path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(file_path))))
sys.path.append(root_path)
sys.path.append(os.path.join(root_path,"module"))
import torch
import numpy as np


from module.physics_property.band.band import Band

band = Band()

band.get_data("/data/home/kongfh/DFTBAI1/example/BAND-total/MnTe2-metal/BAND.dat")
#band.get_data("/home/hp/users/kfh/DFTBAI1/example/test_TB/Si_like/Si_PC/BAND.dat")
print(band.content['k_vector'].shape)
print(band.content["energy"].shape)

band_index = [i for i in range(72,82)]
model_index = [i for i in range(14,34)]

# band.plot_data("/home/hp/users/kfh/DFTBAI1/example/test_TB/MgO/DFT_MgO.png",band_index)

para_input = torch.tensor([[ 8.8870e-02, -1.4146e+00,  1.2450e+00, -3.6168e-01,  6.9505e-01,
          1.0637e+00, -1.4573e-01,  6.2475e-01, -3.1389e+00,  1.8355e+00,
          1.1611e+00, -4.9038e-01, -2.0488e+00, -2.2836e+00,  1.4351e-01,
         -7.5583e-01, -1.4558e-01,  1.5079e+00,  2.2718e+00,  2.5133e+00,
          1.6135e-01, -2.2518e+00, -1.1872e-01,  4.5222e-01, -8.5346e-01,
         -1.0528e-01, -3.9588e-02, -1.5310e-01, -1.5730e+00,  8.6925e-01,
         -1.1493e-01,  1.4983e+00,  9.3925e-01, -3.3736e-01,  2.1305e-01,
          1.3250e+00,  1.0698e+00,  2.5977e-02, -3.6157e-01,  1.7057e+00,
          7.9849e-01,  2.2396e+00,  2.7140e-02, -1.3164e+00,  8.1773e-01,
          3.3374e-01,  5.2271e-01,  4.1800e-01, -2.6968e+00,  1.6201e+00,
         -9.7900e-01, -1.8823e+00,  1.0019e+00, -1.4620e+00, -3.8689e-01,
          4.4669e-01,  7.5323e-02, -6.9522e-01, -1.2486e+00,  2.5906e-01,
         -1.1435e+00,  4.7274e-01, -1.8291e+00,  2.2365e+00,  5.2905e-02,
          2.3637e-01, -6.5146e-02,  4.5366e-02,  1.4729e-02, -9.3629e-02,
         -2.2910e-01, -1.8111e-01, -1.5402e-01,  2.0940e-01, -9.9959e-02,
          9.1475e-02,  2.0730e-01, -1.7990e-01,  1.5587e-02, -2.9228e-01,
         -2.4764e-01, -6.3716e-02, -1.6445e-01, -1.8575e-01, -2.9004e-02,
         -2.1678e-02, -1.3525e-01, -4.8067e-02, -2.0002e-01, -1.6016e-01,
          1.3813e-01,  2.4126e-01, -1.3110e-01,  1.7549e-02,  7.9259e-02,
          1.6106e-03,  1.5765e-01, -2.3034e-01,  6.5840e-02,  4.4702e-02,
         -4.2964e-01, -9.5052e-01, -2.1322e-01,  1.2348e-01,  2.2746e-01,
          1.0557e+00,  1.1776e+00,  9.2272e-01, -4.2532e-01,  8.9702e-01,
          2.0766e-01, -5.4328e-03, -5.6930e-01,  1.3431e+00, -6.7049e-02,
         -5.4714e-01,  3.8067e-01,  1.3591e+00, -4.4657e-01, -3.2258e-01,
         -4.5785e-01, -6.9044e-01,  2.6331e-01,  5.0365e-01, -1.8177e+00,
          1.9729e-02, -1.2743e+00, -2.3465e-01, -3.8946e-01,  6.1031e-01,
          5.9471e-01, -1.0800e+00, -4.1227e-01,  7.4444e-01,  4.3042e-01,
         -1.2649e-01, -3.8879e-02,  5.2239e-01, -1.3985e-02,  1.2987e+00,
          1.6406e-01, -6.8657e-01,  6.5428e-01, -9.4317e-01, -2.8408e-01,
          3.4885e-01,  2.6999e-01, -2.2675e+00, -5.8569e-01,  1.1123e+00,
         -1.6700e+00,  1.8993e-01,  2.4532e-01,  6.6887e-01, -4.0604e-01,
         -1.6205e+00,  6.6559e-01,  8.7570e-01, -5.3276e-02,  4.4709e-02,
          7.2517e-01,  1.4178e-01,  6.6480e-01,  4.3441e-01,  2.3686e-01,
         -6.1408e-01,  5.6459e-01, -1.3614e+00,  7.1953e-02,  4.3900e-01,
         -1.3462e+00, -1.5623e+00,  6.1982e-01,  5.6597e-01,  8.9774e-02,
          8.6374e-01,  1.9014e-01, -1.4663e-01, -8.6850e-01, -1.2296e-02,
          8.0941e-01, -7.8165e-01, -2.4261e-01,  2.8634e-01,  3.0877e-01,
         -4.6700e-01,  4.3004e-01, -1.2501e-01, -5.8436e-01, -4.8513e-01,
         -5.8972e-01,  2.9330e-01,  2.4596e-01, -1.5252e-03, -1.0651e+00,
          5.9516e-01,  2.5600e-01,  2.1120e-01,  1.5058e+00,  1.3889e-01,
          1.5954e-01, -7.6098e-01,  8.0429e-02,  8.1251e-01, -6.3881e-02,
         -7.3098e-01,  3.6487e-01, -4.3151e-01,  2.1850e-01, -5.0448e-02,
         -1.7654e-01, -2.2175e-01, -3.3785e-01, -1.7198e-01, -9.9496e-01,
          1.2082e+00, -3.1643e-01,  2.2874e-01,  4.6948e-01,  9.2690e-01,
          2.7176e-01, -2.4313e-01, -4.3924e-02,  6.1850e-01, -1.2670e-01,
          3.1293e-01, -2.2451e-01,  5.4403e-01, -2.6033e-01, -2.9246e-01,
         -2.6575e-01,  3.6201e-01, -2.8393e-01, -2.0021e-01,  2.3865e-01,
         -4.5993e-01, -6.7693e-01,  2.9407e-01, -7.7201e-02, -3.1117e-01,
          3.6478e-02, -4.8366e-01, -5.7296e-01,  8.1229e-01, -6.3790e-01,
         -3.3480e-01,  2.0067e-01, -1.1074e+00, -1.0139e+00, -2.8212e-01,
          5.3715e-01,  3.2097e-01, -1.1614e+00, -1.5399e-01,  3.2555e-01,
         -5.7220e-01, -5.6778e-01,  5.7357e-02, -4.2727e-01,  9.5437e-01,
         -3.2134e-01, -1.5273e-01,  6.2843e-01,  6.3307e-01, -2.1531e-01,
          1.8485e-01,  1.6574e+00, -1.3277e+00, -1.1274e+00,  1.5312e+00,
         -1.3936e+00,  7.1438e-02,  5.9214e-01,  5.2022e-01, -2.4641e-01,
         -2.3637e+00,  9.2346e-01,  1.1902e+00,  7.0709e-02, -2.1133e-01,
          1.0381e+00, -8.5605e-04,  3.9675e-01,  9.3979e-01,  7.3182e-01,
         -9.5454e-01,  5.6339e-01, -8.5451e-01,  4.2392e-02,  7.7571e-01,
         -9.7702e-01, -2.1742e+00,  1.1728e-01,  6.3841e-03,  4.0539e-02,
         -2.3309e-01,  1.2856e-01,  6.6871e-03,  2.6814e-02,  1.5754e-02,
          1.9865e-01,  2.8903e-01, -9.4051e-02,  3.4936e-02, -1.2167e-01,
          6.5787e-02, -9.5742e-03,  1.2422e-01,  7.6035e-02,  1.3377e-01,
         -2.5861e-02,  5.3651e-02, -9.2174e-02,  2.4565e-01, -3.5093e-02,
          2.9314e-01, -2.5735e-01,  5.0797e-02,  3.5992e-02,  4.0359e-02,
          1.7106e-02,  1.3805e-01, -2.6315e-02,  2.2035e-03, -5.7663e-02,
          4.3079e-02, -9.2450e-02, -4.6196e-02,  4.3901e-01,  6.4826e-02,
          9.5712e-02, -1.6654e-01, -1.5904e-01, -1.8465e-01, -4.8861e-02,
         -1.2155e-01,  1.3194e-01, -2.3312e-01,  1.2220e-01, -2.0405e-01,
          9.2057e-02, -2.7471e-02, -7.6761e-03, -1.0257e-01, -3.1150e-02,
         -4.5054e-02, -7.4420e-02, -3.0002e-01,  1.0738e-01,  3.7970e-02,
         -1.1518e-01, -4.8527e-02, -1.4240e-01, -1.8521e-01,  6.7923e-02,
          5.5158e-02,  1.8718e-01,  4.8861e-02, -5.0715e-02, -1.4402e-01,
         -1.3633e-01,  3.3480e-01,  4.2893e-02,  4.3541e-02,  7.2650e-01,
         -5.0057e-01,  1.0140e+00,  1.0685e+00, -1.5594e+00,  3.3266e-01,
          1.0796e+00, -1.8888e-01,  4.2794e-01,  2.6874e-01, -1.5201e-01,
          1.1908e+00, -6.3094e-01,  3.0502e-01, -4.1594e-02,  6.4884e-01,
          7.5151e-01,  2.3529e-01,  5.8124e-01, -3.8684e-01,  9.4172e-01,
         -4.3029e-01,  3.5715e-01, -8.8308e-01, -2.1569e-01, -1.3448e+00,
          8.6961e-01, -1.3711e+00,  1.8286e+00,  1.2875e+00,  1.4617e-01,
         -9.3264e-01, -4.1538e-01, -5.3546e-02, -3.4797e-01,  1.5796e+00,
          2.8551e-01, -1.3420e+00, -1.1198e+00, -4.8059e-01, -1.0278e+00,
         -4.0866e-01, -2.9134e-01,  6.6554e-01,  7.6886e-01,  3.5290e-01,
          1.3655e+00,  2.3419e-01,  9.8240e-01,  1.2294e+00, -1.2198e-01,
         -5.3463e-02, -3.8859e-01, -3.9702e-01, -3.9636e-01,  9.9143e-01,
          1.5649e-01, -9.8484e-01,  8.6844e-01,  7.7729e-01,  2.4370e-01,
         -3.8318e-01, -7.9695e-02, -7.1178e-02, -7.5747e-01,  3.7624e-01,
         -1.3164e-01,  3.5011e-01, -2.7580e-01,  2.2033e-01, -1.5192e-01,
         -1.0872e+00,  2.1970e-01,  1.1786e+00, -4.1648e-01, -8.7646e-01,
         -9.4796e-02, -7.5403e-02, -9.8590e-01, -8.2909e-01, -3.7449e-01,
         -3.1827e-01,  3.0245e-01,  1.1066e-01, -1.0312e+00,  5.9184e-01,
         -3.0195e-01, -4.4757e-01, -1.0404e+00,  4.5300e-01,  1.0194e-01,
         -3.3176e-01, -1.7613e+00, -6.0608e-01,  4.5567e-01, -1.2549e+00,
          2.6092e-01,  2.7034e-01,  3.2757e-01, -5.3523e-01, -2.3914e-01,
         -7.1594e-01, -1.6863e-01,  5.5494e-01, -2.4612e-01,  2.1387e-01,
         -1.4020e-01,  5.5769e-01, -6.4301e-02, -3.7740e-01, -4.6045e-01,
         -1.8154e-02,  4.1764e-01,  3.2782e-01,  2.5566e-01, -1.1956e-01,
         -2.6460e-01,  1.4204e-01, -3.2999e-01, -2.7846e-02,  6.9667e-01,
          8.4968e-01, -9.7300e-01,  2.9906e-01,  1.4024e+00,  8.1773e-01,
          6.4687e-01, -1.2637e-01, -1.3684e-01,  8.2589e-03,  1.2778e-01,
         -1.3821e-02, -1.2054e-01, -8.4959e-02,  5.6308e-02,  2.4665e-01,
         -3.4352e-02,  1.8392e-01, -1.3177e-01,  4.8328e-02,  9.8048e-02,
          1.9177e-02,  3.6302e-02,  6.0886e-03, -1.1175e-01, -1.1361e-01,
          1.9450e-01,  1.2636e-01, -1.5948e-01, -1.9028e-01,  2.7859e-01,
          6.9732e-02,  4.7642e-02,  5.2720e-02, -1.0584e-01, -1.0596e-01,
          1.0552e-01, -2.6802e-01, -8.1736e-02, -2.5778e-01,  1.6669e-01,
         -4.2123e-02, -3.7606e-02,  1.8327e-01]])
para_input = torch.tensor(
    [[ 1.5197e+00, -1.7604e+00, -3.6427e-01, -1.2348e+00, -7.3295e-02,
          1.1720e-01,  8.1609e-01,  1.5026e+00,  1.1036e+00,  1.8281e+00,
         -2.5125e-02, -4.1631e-01,  4.2383e-01,  1.2442e-01, -1.9625e+00,
          2.5890e+00, -1.7704e+00, -3.2022e-01, -8.5053e-02,  2.0900e+00,
         -3.8666e-01,  7.9899e-01, -2.7294e-01,  1.6058e+00, -9.7723e-01,
          1.0479e+00,  1.8274e+00,  1.0983e+00, -1.4105e-01,  5.8705e-03,
         -4.0941e-01, -8.0552e-01,  7.0373e-01,  2.1665e+00, -1.1799e-02,
         -5.4192e-02,  4.0397e-01,  3.6578e-01,  1.0075e+00,  9.5999e-01,
         -3.7159e-01,  1.8361e+00,  9.1253e-01,  1.0158e+00, -6.3736e-01,
          1.2570e-01,  5.3431e-01, -9.4370e-01,  8.3054e-01,  4.0370e-01,
         -7.3745e-01,  4.0655e-01, -1.0912e+00,  3.9074e-01, -1.9340e-01,
         -1.5015e+00, -6.2658e-01,  4.1583e-01,  2.5630e+00, -2.5509e-01,
          3.3385e-01,  3.1338e+00,  9.0402e-01,  3.3070e-02,  6.1505e-01,
          1.1847e+00, -4.7513e-01, -5.3326e-01,  9.6502e-01, -2.2243e-01,
          6.2832e-01,  1.6362e-01,  1.5690e+00, -8.8298e-01,  1.0609e+00,
          1.7610e+00, -1.4660e+00,  6.4725e-01,  1.0878e+00,  5.0383e-01,
         -7.5618e-01,  9.8392e-02, -5.4729e-01, -1.3977e+00,  1.6207e-01,
         -3.3803e-01,  1.3100e-02, -6.7648e-01,  1.2684e+00,  6.8311e-01,
         -8.9694e-01,  1.2084e+00,  3.2097e+00, -4.7404e-01, -1.6226e+00,
          3.1645e-01, -1.5308e+00, -1.9597e-01,  6.0838e-01, -4.0673e-01,
          7.9869e-01,  1.3361e-01, -1.0123e-01, -6.1253e-02, -6.1745e-02,
         -1.3312e-01,  2.6780e-01,  3.7251e-01, -1.9707e-02, -4.0427e-01,
          2.5544e-01,  2.8188e-01, -4.0624e-02, -3.2877e-01, -2.7778e-01,
          3.7980e-02,  4.3627e-01, -2.1832e-03, -2.6944e-01,  6.4710e-02,
          4.0293e-01, -2.0126e-01,  6.1104e-02,  1.9976e-01,  3.0101e-01,
          1.1034e-04, -5.6418e-02,  4.2463e-01, -2.4548e-01, -1.9041e-01,
          1.7366e-01,  3.7186e-02,  2.2085e-01, -4.5150e-01,  5.1569e-03,
          5.1495e-01, -4.7631e-01,  8.4941e-01,  7.1204e-01,  3.9854e-01,
         -1.8331e+00,  1.6470e+00,  2.4647e-01,  1.8811e+00,  3.4508e-01,
         -1.7506e-01, -2.2827e-01,  1.2514e+00, -9.4175e-01,  1.4710e+00,
          1.0537e+00,  4.9048e-01,  1.3728e+00, -3.2474e-01, -3.6744e-01,
          5.4594e-01,  1.4287e+00,  5.0248e-01, -9.5845e-01, -1.5697e+00,
          6.7065e-01,  2.0424e-01,  9.6237e-01,  3.2460e-01, -2.5325e-01,
         -7.6764e-01, -8.5360e-01, -5.4599e-02,  7.0333e-01,  1.0287e-01,
         -1.2237e+00, -1.2008e+00, -3.5024e-01, -3.3482e-01, -1.1057e+00,
          9.6409e-01,  2.6143e-01,  5.9407e-01, -1.0815e+00, -1.5983e+00,
          8.3514e-01,  4.4604e-02,  2.2774e-01,  3.8437e-01, -4.4168e-01,
          6.0310e-02, -6.1805e-01, -1.5915e-01, -3.4297e-01,  1.5470e-01,
          2.9723e-01,  6.7461e-01, -1.4321e-01,  2.3092e-01,  3.7492e-01,
          1.1718e+00,  2.7475e-01,  1.1384e-01,  1.0087e+00,  5.4297e-02,
          1.4953e-01, -2.8120e-01, -6.6287e-01,  1.2432e+00,  8.7183e-02,
         -5.9697e-01,  2.8922e-01, -6.2891e-01,  8.0048e-02, -4.6743e-01,
         -3.1131e-01, -1.3312e-01, -1.4614e-01, -1.1331e+00, -8.4070e-01,
          1.5073e-02,  2.4991e-01,  5.7027e-02, -4.4789e-01,  2.4486e-01,
         -6.4838e-02, -5.6734e-01, -2.5109e-01,  1.5039e-01, -1.1945e-01,
          3.9869e-01,  2.9625e-02, -1.1521e-01, -9.9264e-01,  1.7725e-01,
          5.0390e-01,  3.9393e-02,  1.8614e+00, -4.0155e-01,  5.8428e-01,
          4.3608e-01,  6.3221e-01, -1.4987e+00,  9.4852e-01, -6.5912e-01,
          1.6484e+00, -6.5539e-02,  2.1336e-01, -1.5264e+00,  1.8791e+00,
         -2.2782e+00, -1.1240e+00,  7.1742e-01, -6.5456e-01, -6.8592e-01,
         -1.6554e+00, -4.7994e-01, -6.4481e-01, -2.0376e-01,  1.3544e-01,
          1.8858e+00,  2.1404e-01, -6.9968e-01, -1.3494e-01, -2.9438e-01,
         -1.0199e+00, -2.0292e-01,  1.5569e-01, -1.1383e+00,  3.5684e-02,
         -8.9675e-01, -1.9400e-01,  3.5697e-02, -1.0316e+00, -1.4482e+00,
          7.5068e-01, -5.5743e-02, -3.9363e-01,  1.5074e-01,  6.1804e-01,
          2.2293e+00, -8.3532e-01, -5.9963e-01,  7.9456e-01, -2.9166e-01,
         -6.9858e-02, -7.1285e-01, -9.3825e-01, -3.9176e-01,  5.4929e-01,
         -8.3933e-01,  5.2250e-01, -9.0567e-01, -2.5280e-01, -2.5682e-01,
          1.1114e+00,  1.9727e-01,  4.8184e-01, -1.6569e+00,  5.6836e-01,
         -5.1271e-01, -1.1271e+00, -2.3589e-01,  3.2867e-01,  1.5909e+00,
         -1.1008e+00, -4.3225e-01,  6.5670e-01,  6.6088e-01,  7.0750e-01,
          7.5703e-01,  1.5510e+00,  5.2828e-01, -6.0592e-01,  1.5837e+00,
          1.6817e-01, -5.4866e-01,  5.6378e-01, -8.3726e-01,  2.8239e-01,
         -9.9920e-01, -1.3913e+00, -2.5595e-01, -8.5662e-01, -6.1551e-01,
          1.7274e-01, -3.8168e-02,  2.6452e+00, -8.7835e-01,  8.4049e-01,
          1.4181e+00, -1.2469e+00,  6.4328e-02, -4.7397e-01, -1.2837e-01,
         -1.5202e+00, -6.6282e-01,  5.5448e-01, -2.3501e-01, -1.9102e-01,
          5.5780e-01, -1.0183e+00,  6.2632e-01,  7.7453e-01,  1.3865e+00,
          6.3503e-01,  9.9593e-01,  1.6888e-01, -1.9936e-01, -1.8085e-01,
         -3.4368e-01,  3.8342e-01, -2.9523e-01, -7.5849e-01,  3.9611e-02,
          3.7799e-01,  2.0491e-01, -3.0844e-01,  8.2940e-01,  3.7837e-01,
         -1.1856e-01,  5.0327e-01,  1.4275e+00,  7.1522e-02, -4.2118e-01,
         -6.4961e-01, -7.1630e-02,  3.0806e-01,  3.2593e-01, -8.2542e-01,
          1.0010e+00, -3.5696e-01, -8.8667e-01,  9.9977e-02,  1.7891e-01,
          2.1991e+00, -1.1000e+00,  6.9826e-01,  3.0379e-01, -6.4211e-01,
         -9.2901e-02,  1.0717e-01, -1.4010e-01, -1.7187e-01, -5.1186e-02,
         -2.7815e-01, -3.1193e-02, -1.1153e-01, -2.8021e-01, -1.3501e-01,
          9.7031e-02,  4.8677e-02, -1.1208e-01,  5.4152e-02,  5.3827e-03,
         -8.9563e-02, -1.8977e-01,  3.9103e-01,  1.8333e-01, -1.1823e-01,
          9.4509e-02,  3.9238e-01,  1.0958e-01,  2.7688e-01, -5.4317e-02,
          7.6150e-02, -1.7223e-01,  5.6695e-03,  1.7027e-01,  4.6318e-02,
          3.8055e-03, -1.6900e-01, -1.2361e-01, -4.1786e-01,  2.7965e-02,
          2.4486e-01, -6.5993e-02,  1.2523e-01,  2.6511e-02,  4.1474e-01,
         -2.9408e-01,  3.1977e-01, -9.4897e-02,  1.4731e-01,  6.6875e-02,
          1.2575e-02, -4.5030e-02, -1.9738e-01, -1.1793e-01, -1.7471e-02,
         -9.4558e-02,  8.0336e-02,  6.4711e-02,  1.9106e-01,  7.2276e-02,
         -1.1611e-01, -7.5729e-04,  8.5798e-02,  2.0465e-01, -8.4646e-02,
         -4.6837e-01,  1.1838e-02,  1.2883e-01, -4.1913e-01, -1.9832e-01,
         -2.6148e-01,  2.9704e-02,  1.4428e-01,  8.5006e-02, -4.9464e-01,
         -7.8519e-02,  2.7590e-01,  1.0328e-01,  1.3606e+00,  4.7946e-01,
          2.0358e-01,  6.6253e-01,  1.2984e-01, -1.4460e+00, -1.0629e+00,
         -7.8793e-01,  3.3715e-01,  8.8125e-01,  6.3676e-01,  7.4761e-01,
          1.8960e-01, -7.1884e-02, -1.1270e+00, -1.2240e+00, -2.1800e-01,
         -4.0136e-01,  4.2434e-02, -1.2970e+00, -3.5883e-01,  1.4017e-01,
         -9.9128e-01,  3.3029e-01,  1.6318e-01, -4.2206e-01,  4.9536e-01,
          1.7110e-01, -3.9952e-02, -8.9919e-01,  3.5721e-01,  3.7358e-01,
         -8.1977e-01, -7.3412e-01,  1.0649e+00, -1.4425e+00, -2.5803e+00,
          1.1843e+00,  9.8257e-01,  3.7312e-01, -8.0258e-02,  4.4677e-01,
         -1.8655e+00, -4.8503e-01, -2.2062e-01,  2.9658e-01, -7.8188e-01,
          1.4237e-01,  9.6015e-01,  4.5507e-01, -2.7477e-01,  1.1251e+00,
          1.6497e+00,  5.6440e-01, -1.3944e+00, -7.4882e-01,  4.2154e-01,
          4.4328e-01,  7.4821e-01, -1.6741e-01, -5.5204e-01, -3.7373e-01,
          9.3024e-01, -7.4054e-01, -5.0994e-01, -4.2563e-01,  1.0342e-01,
         -2.4547e-01, -4.6570e-01,  1.1311e+00, -3.9843e-01, -1.4520e+00,
         -4.6716e-02, -4.2642e-01,  3.6559e-01,  6.9734e-01, -2.5108e-01,
          8.1091e-01,  1.6919e+00, -1.4707e+00, -6.3012e-01, -9.1686e-01,
          3.5043e-01,  1.2083e+00,  6.2550e-01,  2.3628e-01,  8.0549e-01,
          1.0759e+00,  5.3598e-01,  1.1503e-01, -5.8982e-01,  1.1284e+00,
          6.4632e-01, -2.5822e-01, -4.1780e-01, -1.4202e+00, -9.8187e-01,
         -1.4437e-01, -5.7940e-02, -7.9952e-02, -1.3527e+00,  2.6320e-01,
          6.6610e-01,  1.5075e-01,  5.5606e-01, -2.3392e-01, -1.0950e+00,
          7.2371e-01, -6.6396e-02,  6.1413e-01, -5.0700e-01, -1.9225e+00,
          4.8021e-02, -2.5073e+00,  3.3561e-01,  1.5688e-01,  4.6943e-01,
          3.5022e-01,  6.0259e-01, -7.2421e-01, -2.0992e-01,  1.2084e+00,
          2.5090e-01,  5.6007e-01,  7.6107e-02,  1.3059e+00,  1.5314e-01,
         -1.6069e+00,  5.6344e-02,  7.9082e-01,  4.0095e-02,  1.8873e+00,
          1.9611e+00,  1.0061e+00, -1.3982e+00,  1.8287e-01,  1.5101e+00,
          3.0768e-01, -9.8139e-02, -5.5824e-01, -2.0830e-01, -5.8744e-01,
          2.8904e-01, -3.2816e-01, -1.2478e-01,  8.3125e-01, -1.3307e+00,
          5.9398e-01,  2.8360e-01, -2.2911e-01,  5.7588e-01,  1.1186e+00,
         -1.2311e-01,  1.5358e+00,  1.7695e+00,  4.9372e-01, -6.4741e-01,
         -4.7050e-01, -8.7985e-02, -3.4045e-01, -3.7256e-01, -2.3996e-01,
          2.1184e-01,  6.0742e-01, -2.5944e-01,  5.7403e-01, -1.2061e+00,
         -1.1463e+00, -4.6337e-01, -5.3046e-02,  7.3705e-01,  7.0589e-01,
          9.1278e-02,  1.9488e-02, -3.9466e-01,  9.8196e-02,  7.8690e-02,
          8.3504e-01, -2.7435e-01,  4.1288e-01,  5.8170e-01, -5.9330e-01,
         -1.8264e+00,  1.4407e+00,  2.7675e-01,  1.2544e-01,  1.3319e+00,
         -9.7760e-01, -4.7446e-01,  3.4064e-01, -1.1036e+00,  3.0318e-01,
         -2.0705e-01, -7.9484e-01, -9.8559e-02, -3.6850e-01,  7.8896e-01,
         -2.2470e-01, -9.0965e-01, -5.1280e-01,  2.5862e-01, -1.0488e-02,
         -9.5362e-02,  5.4820e-02,  1.0828e-01,  9.3392e-02,  1.0634e-02,
          4.9405e-02, -3.3722e-01,  2.7194e-02, -1.7737e-01, -4.4536e-01,
          7.7976e-02, -2.0510e-01, -8.5444e-02, -1.4542e-01, -8.8238e-02,
          1.0081e-02,  3.9546e-01, -9.2604e-02, -2.0308e-01,  1.3018e-02,
          2.4688e-01,  3.3855e-02,  7.0000e-02, -2.1541e-01, -1.4541e-01,
         -2.7817e-01,  1.7499e-01,  9.8378e-02, -6.4503e-02, -2.4377e-01,
         -3.8210e-01,  1.2685e-01,  1.2731e-01, -2.6229e-01]]
)

para_input = torch.tensor([[ 1.5197e+00, -1.7604e+00, -3.6427e-01, -1.2348e+00, -7.3295e-02,
          1.1720e-01,  8.1609e-01,  1.5026e+00,  1.1036e+00,  1.8281e+00,
         -2.5125e-02, -4.1631e-01,  4.2383e-01,  1.2442e-01, -1.9625e+00,
          2.5890e+00, -1.7704e+00, -3.2022e-01, -8.5053e-02,  2.0900e+00,
         -3.8666e-01,  7.9899e-01, -2.7294e-01,  1.6058e+00, -9.7723e-01,
          1.0479e+00,  1.8274e+00,  1.0983e+00, -1.4105e-01,  5.8705e-03,
         -4.0941e-01, -8.0552e-01,  7.0373e-01,  2.1665e+00, -1.1799e-02,
         -5.4192e-02,  4.0397e-01,  3.6578e-01,  1.0075e+00,  9.5999e-01,
         -3.7159e-01,  1.8361e+00,  9.1253e-01,  1.0158e+00, -6.3736e-01,
          1.2570e-01,  5.3431e-01, -9.4370e-01,  8.3054e-01,  4.0370e-01,
         -7.3745e-01,  4.0655e-01, -1.0912e+00,  3.9074e-01, -1.9340e-01,
         -1.5015e+00, -6.2658e-01,  4.1583e-01,  2.5630e+00, -2.5509e-01,
          3.3385e-01,  3.1338e+00,  9.0402e-01,  3.3070e-02,  6.1505e-01,
          1.1847e+00, -4.7513e-01, -5.3326e-01,  9.6502e-01, -2.2243e-01,
          6.2832e-01,  1.6362e-01,  1.5690e+00, -8.8298e-01,  1.0609e+00,
          1.7610e+00, -1.4660e+00,  6.4725e-01,  1.0878e+00,  5.0383e-01,
         -7.5618e-01,  9.8392e-02, -5.4729e-01, -1.3977e+00,  1.6207e-01,
         -3.3803e-01,  1.3100e-02, -6.7648e-01,  1.2684e+00,  6.8311e-01,
         -8.9694e-01,  1.2084e+00,  3.2097e+00, -4.7404e-01, -1.6226e+00,
          3.1645e-01, -1.5308e+00, -1.9597e-01,  6.0838e-01, -4.0673e-01,
          7.9869e-01,  1.3361e-01, -1.0123e-01, -6.1253e-02, -6.1745e-02,
         -1.3312e-01,  2.6780e-01,  3.7251e-01, -1.9707e-02, -4.0427e-01,
          2.5544e-01,  2.8188e-01, -4.0624e-02, -3.2877e-01, -2.7778e-01,
          3.7980e-02,  4.3627e-01, -2.1832e-03, -2.6944e-01,  6.4710e-02,
          4.0293e-01, -2.0126e-01,  6.1104e-02,  1.9976e-01,  3.0101e-01,
          1.1034e-04, -5.6418e-02,  4.2463e-01, -2.4548e-01, -1.9041e-01,
          1.7366e-01,  3.7186e-02,  2.2085e-01, -4.5150e-01,  5.1569e-03,
          5.1495e-01, -4.7631e-01,  8.4941e-01,  7.1204e-01,  3.9854e-01,
         -1.8331e+00,  1.6470e+00,  2.4647e-01,  1.8811e+00,  3.4508e-01,
         -1.7506e-01, -2.2827e-01,  1.2514e+00, -9.4175e-01,  1.4710e+00,
          1.0537e+00,  4.9048e-01,  1.3728e+00, -3.2474e-01, -3.6744e-01,
          5.4594e-01,  1.4287e+00,  5.0248e-01, -9.5845e-01, -1.5697e+00,
          6.7065e-01,  2.0424e-01,  9.6237e-01,  3.2460e-01, -2.5325e-01,
         -7.6764e-01, -8.5360e-01, -5.4599e-02,  7.0333e-01,  1.0287e-01,
         -1.2237e+00, -1.2008e+00, -3.5024e-01, -3.3482e-01, -1.1057e+00,
          9.6409e-01,  2.6143e-01,  5.9407e-01, -1.0815e+00, -1.5983e+00,
          8.3514e-01,  4.4604e-02,  2.2774e-01,  3.8437e-01, -4.4168e-01,
          6.0310e-02, -6.1805e-01, -1.5915e-01, -3.4297e-01,  1.5470e-01,
          2.9723e-01,  6.7461e-01, -1.4321e-01,  2.3092e-01,  3.7492e-01,
          1.1718e+00,  2.7475e-01,  1.1384e-01,  1.0087e+00,  5.4297e-02,
          1.4953e-01, -2.8120e-01, -6.6287e-01,  1.2432e+00,  8.7183e-02,
         -5.9697e-01,  2.8922e-01, -6.2891e-01,  8.0048e-02, -4.6743e-01,
         -3.1131e-01, -1.3312e-01, -1.4614e-01, -1.1331e+00, -8.4070e-01,
          1.5073e-02,  2.4991e-01,  5.7027e-02, -4.4789e-01,  2.4486e-01,
         -6.4838e-02, -5.6734e-01, -2.5109e-01,  1.5039e-01, -1.1945e-01,
          3.9869e-01,  2.9625e-02, -1.1521e-01, -9.9264e-01,  1.7725e-01,
          5.0390e-01,  3.9393e-02,  1.8614e+00, -4.0155e-01,  5.8428e-01,
          4.3608e-01,  6.3221e-01, -1.4987e+00,  9.4852e-01, -6.5912e-01,
          1.6484e+00, -6.5539e-02,  2.1336e-01, -1.5264e+00,  1.8791e+00,
         -2.2782e+00, -1.1240e+00,  7.1742e-01, -6.5456e-01, -6.8592e-01,
         -1.6554e+00, -4.7994e-01, -6.4481e-01, -2.0376e-01,  1.3544e-01,
          1.8858e+00,  2.1404e-01, -6.9968e-01, -1.3494e-01, -2.9438e-01,
         -1.0199e+00, -2.0292e-01,  1.5569e-01, -1.1383e+00,  3.5684e-02,
         -8.9675e-01, -1.9400e-01,  3.5697e-02, -1.0316e+00, -1.4482e+00,
          7.5068e-01, -5.5743e-02, -3.9363e-01,  1.5074e-01,  6.1804e-01,
          2.2293e+00, -8.3532e-01, -5.9963e-01,  7.9456e-01, -2.9166e-01,
         -6.9858e-02, -7.1285e-01, -9.3825e-01, -3.9176e-01,  5.4929e-01,
         -8.3933e-01,  5.2250e-01, -9.0567e-01, -2.5280e-01, -2.5682e-01,
          1.1114e+00,  1.9727e-01,  4.8184e-01, -1.6569e+00,  5.6836e-01,
         -5.1271e-01, -1.1271e+00, -2.3589e-01,  3.2867e-01,  1.5909e+00,
         -1.1008e+00, -4.3225e-01,  6.5670e-01,  6.6088e-01,  7.0750e-01,
          7.5703e-01,  1.5510e+00,  5.2828e-01, -6.0592e-01,  1.5837e+00,
          1.6817e-01, -5.4866e-01,  5.6378e-01, -8.3726e-01,  2.8239e-01,
         -9.9920e-01, -1.3913e+00, -2.5595e-01, -8.5662e-01, -6.1551e-01,
          1.7274e-01, -3.8168e-02,  2.6452e+00, -8.7835e-01,  8.4049e-01,
          1.4181e+00, -1.2469e+00,  6.4328e-02, -4.7397e-01, -1.2837e-01,
         -1.5202e+00, -6.6282e-01,  5.5448e-01, -2.3501e-01, -1.9102e-01,
          5.5780e-01, -1.0183e+00,  6.2632e-01,  7.7453e-01,  1.3865e+00,
          6.3503e-01,  9.9593e-01,  1.6888e-01, -1.9936e-01, -1.8085e-01,
         -3.4368e-01,  3.8342e-01, -2.9523e-01, -7.5849e-01,  3.9611e-02,
          3.7799e-01,  2.0491e-01, -3.0844e-01,  8.2940e-01,  3.7837e-01,
         -1.1856e-01,  5.0327e-01,  1.4275e+00,  7.1522e-02, -4.2118e-01,
         -6.4961e-01, -7.1630e-02,  3.0806e-01,  3.2593e-01, -8.2542e-01,
          1.0010e+00, -3.5696e-01, -8.8667e-01,  9.9977e-02,  1.7891e-01,
          2.1991e+00, -1.1000e+00,  6.9826e-01,  3.0379e-01, -6.4211e-01,
         -9.2901e-02,  1.0717e-01, -1.4010e-01, -1.7187e-01, -5.1186e-02,
         -2.7815e-01, -3.1193e-02, -1.1153e-01, -2.8021e-01, -1.3501e-01,
          9.7031e-02,  4.8677e-02, -1.1208e-01,  5.4152e-02,  5.3827e-03,
         -8.9563e-02, -1.8977e-01,  3.9103e-01,  1.8333e-01, -1.1823e-01,
          9.4509e-02,  3.9238e-01,  1.0958e-01,  2.7688e-01, -5.4317e-02,
          7.6150e-02, -1.7223e-01,  5.6695e-03,  1.7027e-01,  4.6318e-02,
          3.8055e-03, -1.6900e-01, -1.2361e-01, -4.1786e-01,  2.7965e-02,
          2.4486e-01, -6.5993e-02,  1.2523e-01,  2.6511e-02,  4.1474e-01,
         -2.9408e-01,  3.1977e-01, -9.4897e-02,  1.4731e-01,  6.6875e-02,
          1.2575e-02, -4.5030e-02, -1.9738e-01, -1.1793e-01, -1.7471e-02,
         -9.4558e-02,  8.0336e-02,  6.4711e-02,  1.9106e-01,  7.2276e-02,
         -1.1611e-01, -7.5729e-04,  8.5798e-02,  2.0465e-01, -8.4646e-02,
         -4.6837e-01,  1.1838e-02,  1.2883e-01, -4.1913e-01, -1.9832e-01,
         -2.6148e-01,  2.9704e-02,  1.4428e-01,  8.5006e-02, -4.9464e-01,
         -7.8519e-02,  2.7590e-01,  1.0328e-01,  1.3606e+00,  4.7946e-01,
          2.0358e-01,  6.6253e-01,  1.2984e-01, -1.4460e+00, -1.0629e+00,
         -7.8793e-01,  3.3715e-01,  8.8125e-01,  6.3676e-01,  7.4761e-01,
          1.8960e-01, -7.1884e-02, -1.1270e+00, -1.2240e+00, -2.1800e-01,
         -4.0136e-01,  4.2434e-02, -1.2970e+00, -3.5883e-01,  1.4017e-01,
         -9.9128e-01,  3.3029e-01,  1.6318e-01, -4.2206e-01,  4.9536e-01,
          1.7110e-01, -3.9952e-02, -8.9919e-01,  3.5721e-01,  3.7358e-01,
         -8.1977e-01, -7.3412e-01,  1.0649e+00, -1.4425e+00, -2.5803e+00,
          1.1843e+00,  9.8257e-01,  3.7312e-01, -8.0258e-02,  4.4677e-01,
         -1.8655e+00, -4.8503e-01, -2.2062e-01,  2.9658e-01, -7.8188e-01,
          1.4237e-01,  9.6015e-01,  4.5507e-01, -2.7477e-01,  1.1251e+00,
          1.6497e+00,  5.6440e-01, -1.3944e+00, -7.4882e-01,  4.2154e-01,
          4.4328e-01,  7.4821e-01, -1.6741e-01, -5.5204e-01, -3.7373e-01,
          9.3024e-01, -7.4054e-01, -5.0994e-01, -4.2563e-01,  1.0342e-01,
         -2.4547e-01, -4.6570e-01,  1.1311e+00, -3.9843e-01, -1.4520e+00,
         -4.6716e-02, -4.2642e-01,  3.6559e-01,  6.9734e-01, -2.5108e-01,
          8.1091e-01,  1.6919e+00, -1.4707e+00, -6.3012e-01, -9.1686e-01,
          3.5043e-01,  1.2083e+00,  6.2550e-01,  2.3628e-01,  8.0549e-01,
          1.0759e+00,  5.3598e-01,  1.1503e-01, -5.8982e-01,  1.1284e+00,
          6.4632e-01, -2.5822e-01, -4.1780e-01, -1.4202e+00, -9.8187e-01,
         -1.4437e-01, -5.7940e-02, -7.9952e-02, -1.3527e+00,  2.6320e-01,
          6.6610e-01,  1.5075e-01,  5.5606e-01, -2.3392e-01, -1.0950e+00,
          7.2371e-01, -6.6396e-02,  6.1413e-01, -5.0700e-01, -1.9225e+00,
          4.8021e-02, -2.5073e+00,  3.3561e-01,  1.5688e-01,  4.6943e-01,
          3.5022e-01,  6.0259e-01, -7.2421e-01, -2.0992e-01,  1.2084e+00,
          2.5090e-01,  5.6007e-01,  7.6107e-02,  1.3059e+00,  1.5314e-01,
         -1.6069e+00,  5.6344e-02,  7.9082e-01,  4.0095e-02,  1.8873e+00,
          1.9611e+00,  1.0061e+00, -1.3982e+00,  1.8287e-01,  1.5101e+00,
          3.0768e-01, -9.8139e-02, -5.5824e-01, -2.0830e-01, -5.8744e-01,
          2.8904e-01, -3.2816e-01, -1.2478e-01,  8.3125e-01, -1.3307e+00,
          5.9398e-01,  2.8360e-01, -2.2911e-01,  5.7588e-01,  1.1186e+00,
         -1.2311e-01,  1.5358e+00,  1.7695e+00,  4.9372e-01, -6.4741e-01,
         -4.7050e-01, -8.7985e-02, -3.4045e-01, -3.7256e-01, -2.3996e-01,
          2.1184e-01,  6.0742e-01, -2.5944e-01,  5.7403e-01, -1.2061e+00,
         -1.1463e+00, -4.6337e-01, -5.3046e-02,  7.3705e-01,  7.0589e-01,
          9.1278e-02,  1.9488e-02, -3.9466e-01,  9.8196e-02,  7.8690e-02,
          8.3504e-01, -2.7435e-01,  4.1288e-01,  5.8170e-01, -5.9330e-01,
         -1.8264e+00,  1.4407e+00,  2.7675e-01,  1.2544e-01,  1.3319e+00,
         -9.7760e-01, -4.7446e-01,  3.4064e-01, -1.1036e+00,  3.0318e-01,
         -2.0705e-01, -7.9484e-01, -9.8559e-02, -3.6850e-01,  7.8896e-01,
         -2.2470e-01, -9.0965e-01, -5.1280e-01,  2.5862e-01, -1.0488e-02,
         -9.5362e-02,  5.4820e-02,  1.0828e-01,  9.3392e-02,  1.0634e-02,
          4.9405e-02, -3.3722e-01,  2.7194e-02, -1.7737e-01, -4.4536e-01,
          7.7976e-02, -2.0510e-01, -8.5444e-02, -1.4542e-01, -8.8238e-02,
          1.0081e-02,  3.9546e-01, -9.2604e-02, -2.0308e-01,  1.3018e-02,
          2.4688e-01,  3.3855e-02,  7.0000e-02, -2.1541e-01, -1.4541e-01,
         -2.7817e-01,  1.7499e-01,  9.8378e-02, -6.4503e-02, -2.4377e-01,
         -3.8210e-01,  1.2685e-01,  1.2731e-01, -2.6229e-01]])

### MX2_d(no_z2)_p_4n
para_input = torch.tensor([[-1.3031, -0.4361,  0.5266,  0.0129, -0.8536,  0.2142, -1.1889, -2.1324,
         -1.3184,  0.9632, -0.5058,  0.0786, -0.2563, -1.2728, -0.8665, -1.2144,
         -0.1568, -0.5448,  2.1774, -0.8417, -0.1733,  0.2803,  1.5135,  0.8064,
         -0.4489, -1.2866, -1.4658,  0.0826, -1.0586, -0.1044,  1.4805, -0.6680,
          1.3948,  0.1523,  0.5564,  1.9122,  1.2188, -1.3094, -0.7571, -0.5139,
          2.1341,  0.4629,  0.0098,  0.8382,  0.7605,  1.0163, -1.7682, -0.2578,
          0.6368,  0.1974,  0.8935,  0.1866, -0.1955, -0.5126,  0.1069, -1.1714,
         -1.1635, -1.6901,  0.4584,  0.7614, -4.2310, -1.7264, -1.6274, -1.0542,
         -0.2268, -0.3172,  0.1748, -0.3948,  0.3277,  0.1805, -0.5200, -0.2261,
         -0.3535,  0.4013,  0.7551,  0.9035, -0.3100, -0.2242,  0.7336,  0.0605,
          0.5172,  0.0825, -0.0735,  0.1367, -0.6520,  0.2816,  0.1043, -0.1839,
         -0.2853,  0.1810,  0.7833, -0.0274,  0.0660,  0.1906,  0.5015, -0.5535,
         -0.9160,  0.2445, -0.4387, -1.0811, -0.5353, -0.3472,  1.1127, -0.6918,
         -1.4209, -0.9218,  1.9479,  0.4075,  2.4391, -0.7094,  0.6268, -0.2970,
          0.4481,  0.7885,  0.0354, -0.1333, -0.2856, -0.2163,  0.6627, -0.3579,
         -0.4160, -0.0111, -0.6656, -1.0644, -0.2757,  0.6691,  0.5552, -1.5350,
         -0.5202,  0.5200,  0.4772, -0.8278,  1.0765, -1.3721,  0.4320, -1.4340,
         -0.8994,  0.9366,  0.3980,  0.0273, -1.2181, -0.1828, -0.6522,  0.1296,
         -0.8688,  0.7858, -0.0549, -0.3008, -0.9478,  0.0294,  0.9802,  0.9406,
         -0.4641,  0.1031,  0.5264, -0.1363,  0.4802,  0.7994,  1.6461,  1.3079,
         -1.0137, -1.0697, -0.1702,  0.6368,  1.2106, -1.2442, -0.3209, -0.8597,
         -0.4923, -0.5616,  0.7525,  0.0884,  0.2703, -0.5357,  1.7695, -0.1745,
          0.3466, -2.3409, -0.3372,  1.6583,  0.9660,  0.8990,  0.7273, -0.3670,
         -0.5202,  0.9310,  0.3917,  0.0190, -0.3224, -1.3200,  0.5846,  0.1887,
         -0.2644, -0.3825,  0.3599, -1.3709,  0.6968,  0.4778, -0.3795,  0.7662,
          2.4997,  0.6971, -2.4776, -1.2138, -1.0810, -1.0202,  0.0591,  0.0358,
         -1.0360,  0.9229,  1.1733, -0.0832, -0.2560, -0.2197, -0.4432,  0.6882,
          0.0854,  0.8670,  0.4608,  0.0343,  0.1766,  0.1120,  0.0270, -1.1418,
         -0.5838, -0.6509,  0.2628,  0.0663,  0.2155, -1.0226, -0.4904, -1.3222,
          0.4978,  0.2580, -0.0972, -0.2348, -0.5228, -0.0657,  0.4715, -0.2362,
         -0.1212,  0.1706, -0.7902, -0.3286, -0.4146,  0.0449,  1.4136, -0.5305,
         -1.0657, -0.8401,  1.4274,  0.5363,  1.3401,  0.1658,  0.4454, -0.6293,
          0.3493, -1.1623, -0.6409,  0.0912,  0.4815,  0.0143, -0.0165, -0.2593,
         -0.1077, -0.8517,  0.0236,  0.2215, -0.3799, -0.2848, -0.6431, -0.1580,
         -1.1171, -0.1883,  0.5755,  0.3957, -0.5901, -0.3469, -0.4951,  0.6262,
          1.3865, -0.4764, -0.2246, -0.7768,  0.4664,  1.5425,  0.2308, -0.1996,
          0.5492, -0.0292, -0.1664,  0.9247, -0.5833,  0.4657, -0.4090,  0.5636,
          0.3303,  0.5033, -0.0653, -0.5875,  0.0190, -0.7525, -0.0907,  0.0543,
          0.4112,  0.1529, -0.0507,  0.7619, -0.6127, -0.1460,  0.1947, -0.6901,
          0.4509, -0.8610,  0.2215, -1.3222,  0.1987,  0.7663,  0.7176,  0.6093,
         -0.3495,  0.0197, -0.1174,  0.2220, -0.1404, -0.9155, -0.1008, -1.0959,
         -0.0367,  0.8635,  0.7222,  1.2126,  0.0966, -0.1704,  0.0051,  0.0266,
         -0.0286,  0.5001,  0.6210,  0.1999,  0.1800, -0.4252,  0.1981, -0.0518,
         -0.0519,  0.1911, -0.1970,  1.1112,  0.4510, -0.4721,  0.1613, -0.1979,
         -0.5677,  1.3686,  0.1557,  0.8926,  0.1320, -1.0126, -0.3352, -0.7567,
         -0.5397,  1.2162, -0.5798, -0.8511,  0.0071,  0.4046, -0.3538,  0.5530,
         -0.3465,  0.5176,  1.1609, -0.3842, -0.2125, -0.7949,  0.3512, -0.0599,
          1.0434, -0.2317, -0.1172,  0.2266, -0.0469, -0.4126,  0.5273,  2.2821,
         -0.8782,  0.6375, -0.9935, -1.2182,  0.2665, -1.0083, -0.4685, -0.1198,
         -0.0488,  0.3514, -0.6717, -0.5271,  1.5639, -0.1216,  1.9574,  0.3786,
         -0.2822, -0.0414, -0.6152,  0.1822,  0.2120, -0.3244,  0.6284,  1.0220,
         -0.2472,  0.4846, -0.7124,  1.2135, -0.7889, -0.5862, -0.1453, -0.7663,
          0.2100, -0.5776,  1.1011,  0.2647,  0.2590,  0.8109, -0.3170,  0.8556,
          0.4128,  0.1137,  0.2995,  0.7219, -0.7182,  0.8661, -0.1271,  0.7351,
          0.0882, -1.1460,  0.4225, -1.0171,  1.0858,  0.8056,  0.1488,  0.7208,
         -1.1093,  0.8865,  1.0479,  1.2613,  0.4590,  0.1449, -0.0932, -0.5030,
          0.6393,  0.3239, -0.0789, -2.2984,  0.5647, -0.1753,  1.5110,  1.4529,
          0.9355, -0.5603,  0.0853,  1.0843,  0.2324,  0.0732,  1.8359,  0.8957,
         -0.8843, -0.1826, -0.3439,  1.9664, -1.1305,  0.6094,  1.1853,  0.6520,
          0.8083,  0.1366,  0.0079, -0.6580, -0.5688,  0.4863, -0.0338, -0.4458,
          0.3097, -0.7417,  1.3496,  0.1029,  0.0759, -0.1488, -0.3971,  0.2756,
         -0.4719, -0.4242,  0.5896,  0.1218,  0.4394, -0.7486, -0.2962,  0.1058,
          0.1235, -0.7739, -0.1995, -0.5492,  0.2033, -0.5695, -0.2818,  1.0251,
         -0.5925, -0.0561,  1.0658, -0.2021,  0.8261, -0.0274,  0.7784,  0.2929,
         -0.1762, -0.3442,  0.1802, -0.9246,  0.2710, -0.4693,  0.0493,  0.3266,
          0.7652, -0.5020,  0.9085,  0.1440,  0.5287,  0.3047,  0.1776,  0.2560]])

### MX2_d(no_z2)_p_3n
para_input = torch.tensor([[-3.2408e-01,  6.2272e-01, -1.5422e-01, -4.6331e-01, -2.9540e-01,
          1.1632e+00, -9.5527e-01, -1.3872e+00, -1.6039e+00,  1.2390e+00,
         -1.2027e+00,  1.3127e+00, -5.1913e-02, -1.1581e+00,  1.7366e+00,
         -9.0765e-01, -2.1453e-01,  1.9494e-01, -9.1617e-01,  2.5818e-01,
         -1.8917e+00, -1.3191e+00,  6.7091e-01,  4.3195e-01,  1.8962e-01,
         -7.9350e-01,  3.5173e-01,  1.2641e-01, -7.2805e-01,  2.3866e+00,
          1.1021e+00, -9.7296e-01, -9.0230e-03,  1.1856e+00, -1.0827e+00,
          1.7438e+00, -1.0786e+00,  5.7292e-01,  2.4220e+00,  4.0729e-01,
         -1.5892e-01,  3.0733e-01, -1.3335e+00, -2.0981e+00,  1.6463e+00,
         -8.3494e-01,  1.5059e+00,  2.7711e+00, -1.5990e+00, -2.3476e-01,
         -1.9349e+00, -1.5406e-01, -1.2584e+00,  1.0041e+00, -2.5853e-01,
         -3.0533e+00,  4.3441e-02,  1.7450e-01, -1.3437e+00,  2.2101e+00,
         -1.9251e+00, -9.4772e-01,  6.3708e-01,  3.4694e-01, -1.5926e+00,
         -4.1241e-01,  2.3102e-01,  4.5328e-01,  1.0965e+00, -1.6044e-01,
          6.1528e-02, -8.7505e-01,  1.1635e+00, -4.5479e-01,  1.5055e-01,
          1.2704e+00, -6.6299e-01,  3.2109e-01, -3.2401e-01,  6.1656e-01,
         -8.4590e-01,  7.8437e-01, -6.7956e-01,  5.2755e-01, -5.0868e-01,
          5.2524e-01, -1.3762e+00, -5.2201e-01, -1.9147e+00,  3.8506e-01,
         -7.1687e-01, -8.3391e-01, -4.9632e-01,  1.0561e+00, -1.1961e-01,
          7.0727e-01, -1.5443e+00, -2.5938e-01,  6.3402e-03,  2.1543e-02,
          3.3833e-01,  5.2212e-01, -7.8607e-01, -1.7886e+00,  8.9360e-01,
          3.5334e-01,  3.7406e-01, -4.3412e-01,  9.2841e-01,  2.0796e-02,
          8.5044e-01,  6.0102e-01,  6.3742e-01,  1.0524e+00, -4.1198e-01,
         -3.1306e-01,  1.1540e-01, -4.6919e-01,  3.6421e-02, -1.8339e+00,
         -4.7977e-01, -1.0405e+00, -1.0503e-01,  2.6088e-01,  3.5369e-01,
         -5.5237e-02, -1.5618e+00,  3.2184e-01,  1.3300e+00, -6.6182e-01,
         -1.1246e+00, -6.9698e-01, -1.0379e-01, -2.9776e-01,  1.0592e+00,
          8.2697e-02,  8.6338e-01, -4.6256e-01, -1.9863e-01, -8.0597e-02,
         -3.3346e-01, -3.5134e-01, -6.6069e-01, -2.2361e-01,  1.2615e-01,
          3.0413e-01, -1.0841e-01, -2.1331e-01,  3.3734e-01,  4.8250e-01,
          5.9256e-01, -1.4879e+00, -3.0261e-02,  1.0503e-01,  5.1596e-01,
          3.9785e-01,  1.1287e+00,  3.2576e-01,  4.1987e-01,  5.9011e-01,
         -3.1986e-01,  7.1719e-01, -5.3048e-01, -4.8907e-01, -3.0928e-01,
          5.4105e-01,  5.7533e-01, -1.8550e+00, -7.2185e-02, -1.4983e+00,
         -4.6379e-01,  8.2310e-01, -5.1504e-01,  3.4633e-01,  1.6405e-01,
         -4.8969e-01, -4.0081e-01,  3.6693e-01,  6.2943e-01,  3.8620e-01,
          7.9429e-01,  5.8059e-01, -2.6386e-01,  6.9955e-01, -1.4393e+00,
         -2.6331e-01, -7.9244e-01, -1.3775e-01, -3.3313e-01,  1.0897e+00,
          5.4345e-01, -1.2433e+00,  4.3715e-01, -4.7855e-01, -4.2445e-01,
          8.7725e-01, -6.1715e-02, -1.3526e-01,  1.3336e+00,  1.2179e+00,
         -1.6012e+00, -6.3397e-01, -7.1556e-02,  1.1744e+00,  3.1205e-01,
          6.2336e-01, -6.7614e-01, -2.3624e-03, -1.6688e+00, -9.4621e-01,
         -3.5176e-02, -1.8557e-01, -3.3578e-01,  1.2261e+00,  1.0009e+00,
          1.1198e-01,  7.1560e-01, -5.4069e-01, -6.2422e-01,  4.6458e-01,
         -1.5187e-01,  9.2347e-01, -8.2813e-01, -2.4719e-01,  1.4634e+00,
         -5.3830e-01, -4.4009e-01, -5.2325e-01,  4.0555e-01,  2.9076e-01,
          1.0316e+00,  2.8945e-01,  6.7192e-01, -9.8640e-01, -1.1122e+00,
         -6.7713e-01, -6.6115e-01,  2.0655e-03, -4.3723e-01, -6.1221e-01,
          6.5875e-01,  7.1383e-01, -6.3376e-01,  2.0241e-01,  6.5644e-01,
          2.5390e-01,  4.3079e-01,  6.4592e-01, -4.2436e-01, -9.8124e-01,
         -5.8315e-01,  8.4606e-01,  2.0411e-01,  4.8821e-01, -1.1958e-01,
         -3.9724e-01, -6.6907e-01, -1.3189e+00,  1.8329e-02,  3.5409e-01,
          1.3323e-02,  7.9907e-01, -1.5596e-02,  1.1717e+00, -1.0991e-02,
          1.1315e-01,  3.9344e-01,  2.5141e-01,  3.1323e-01, -6.1343e-02,
         -1.4603e+00,  1.8084e+00, -4.4372e-01, -1.7325e+00, -1.6421e-01,
         -1.3129e-01,  4.4713e-01, -3.8994e-01, -1.4664e-01, -1.1747e+00,
         -9.0682e-01, -2.9532e-01, -4.8869e-01,  1.3814e+00,  1.1159e+00,
          4.5836e-01, -6.7946e-01,  1.0223e+00,  2.5231e-01, -1.1657e-01,
          1.1012e+00, -1.8610e-01,  4.3727e-01, -1.1385e-01, -4.2206e-01,
         -4.7821e-01, -7.2296e-01, -4.9353e-01, -2.8309e-01, -2.2365e-01,
          2.5819e-01, -5.4827e-02, -1.0558e-01, -3.8876e-01,  9.2905e-01,
          7.6067e-01, -2.7405e-01,  4.3065e-01,  4.6481e-01,  5.7295e-01,
         -4.2408e-01, -2.2423e-01, -6.0742e-02, -9.4778e-01, -9.3770e-01,
          5.8113e-01,  5.8560e-01,  3.2079e-01,  2.5954e-01, -3.9315e-01,
          4.4004e-01, -4.0753e-01, -1.1173e+00, -4.4325e-02,  4.7626e-01,
         -7.0044e-01, -1.1380e+00, -3.8454e-02,  4.1532e-02,  4.6329e-01,
          5.8821e-01, -2.9194e-01, -1.6678e-01, -1.5471e-01,  7.5813e-02,
          2.9086e-01, -3.9185e-01,  6.0208e-01, -7.7879e-01,  2.1464e-01,
          2.5743e-01,  3.6235e-01,  4.9677e-01, -6.0788e-01,  1.9585e-01,
         -1.6115e-01,  4.9820e-01, -3.5437e-01, -4.0918e-01, -7.9186e-02,
         -2.1770e-01,  2.4050e-01, -4.1551e-02, -4.7889e-01, -4.2338e-01,
         -3.2862e-01, -7.0029e-01,  1.7060e-02,  6.5557e-02,  8.0315e-01,
          8.5443e-02, -8.4106e-01, -1.0935e+00,  6.5445e-01, -9.4596e-01,
         -3.3740e-01, -2.8194e-01, -9.9295e-01,  9.3164e-01, -9.2016e-02,
         -2.5681e-01, -2.7866e-01,  1.9104e+00, -1.1726e+00, -2.5286e-01,
         -2.9256e-01,  4.7631e-01,  2.3306e-01,  1.2035e+00,  9.2836e-02,
         -7.6127e-01, -5.0532e-02,  2.9284e-01,  4.2834e-01, -2.9300e-01,
          6.3482e-01,  7.5111e-01,  4.6954e-01, -2.2756e-01,  1.8333e-01,
          2.1813e-01,  4.3836e-01, -1.6536e+00, -1.2289e+00,  3.5077e-02,
         -8.3227e-01, -2.8724e-01, -6.3659e-01,  2.4257e-01, -2.1565e-01,
          1.1813e+00, -3.4741e-01,  3.7112e-01,  5.1456e-01, -4.6234e-01,
          1.0295e+00, -1.8176e+00,  7.7472e-01,  1.3570e-01,  7.2346e-01,
         -2.4778e-01, -2.4731e-01, -3.8241e-01,  3.3424e-01,  1.0263e+00,
         -1.0284e-01, -7.5985e-01, -4.6527e-01, -1.2712e+00, -1.3598e-01,
         -6.5688e-01, -3.5644e-01,  9.8694e-01, -1.5479e+00, -5.8046e-01,
         -1.0106e+00,  8.7444e-01, -7.1916e-01,  4.3036e-01, -7.8328e-02,
         -1.2958e-01,  4.4349e-01, -2.8211e-01,  5.2505e-01,  7.0465e-01,
          1.9108e+00, -4.8921e-01,  6.2161e-01,  7.3604e-01,  9.4691e-01,
         -9.2087e-01, -1.1418e-01,  2.4094e-01, -1.5992e+00, -1.8643e+00,
         -1.0279e+00, -8.1181e-01, -1.1302e+00,  3.4555e-01,  7.6773e-01,
          5.4328e-01,  1.3177e+00,  7.6080e-02,  1.0387e+00,  5.6665e-01,
         -1.9464e-01, -4.0925e-01, -1.0557e+00, -7.4040e-02, -1.4197e-01,
         -8.2367e-01, -4.7950e-01, -2.4607e-01, -1.1259e-01,  6.1407e-01,
          6.2200e-01, -8.4046e-01,  1.0962e+00, -7.6093e-01, -2.9698e-01,
         -1.0417e+00, -3.8311e-01,  7.9316e-01,  2.8111e-01,  7.6977e-01,
          2.7092e-01, -1.1717e+00, -2.4573e-01,  1.9171e-01, -5.8269e-01,
         -6.6132e-01, -8.0976e-02, -1.0813e+00, -6.5423e-01, -5.0846e-01,
          1.6141e-01, -7.6811e-01,  6.1836e-01, -1.2001e-01,  5.5846e-01,
          3.0802e-01, -1.7725e+00, -1.9838e-01, -4.1067e-02, -1.5205e-01,
          2.2372e-01,  3.4553e-02,  6.7176e-02,  1.3252e-01,  8.7286e-02,
          2.5675e-01, -8.1444e-02,  4.8115e-02, -4.3670e-01, -9.8356e-02,
          2.3964e-01,  1.5874e-01, -4.1057e-01, -7.4355e-02, -1.5952e-01,
          4.6757e-01,  3.5888e-02, -7.7019e-02,  9.6276e-02, -4.4970e-02,
         -1.9745e-01, -1.0559e-01, -1.5409e-01, -2.6764e-01, -3.4072e-01,
         -9.7707e-02, -1.4200e-01, -1.3989e-01,  1.4573e-01, -1.6767e-01,
         -4.2231e-01, -2.9367e-01, -6.5172e-01]])

para_input = torch.tensor([[ 0.5166,  0.8269,  1.1703,  1.6612,  1.9617,  0.6843,  0.9683,  1.8100,
          1.6545,  1.4115,  0.7425,  1.5075,  0.8872,  1.8839,  1.7437,  0.8077,
          1.1059,  1.0743,  1.3658,  0.5721,  0.8485,  1.5241,  0.9353,  1.2027,
          1.2996,  1.0769,  1.4513,  1.2345,  0.2456,  1.8069,  1.2622,  1.4045,
          1.0048,  0.9993,  0.7275,  0.6312,  0.7678,  1.2988,  1.7633,  0.2693,
          1.5080,  0.6709,  1.2760,  1.6468,  1.1674,  1.2440,  0.9826,  1.2248,
          0.2452,  0.5967,  1.1175,  0.9986,  0.9171,  1.1694,  0.9815,  0.6553,
          0.8993,  1.2008,  1.3180,  0.7732,  0.2862,  0.6311,  0.8805,  0.1157,
          0.4576,  0.6327,  0.9080,  1.3351,  1.0178,  1.0046,  1.0795,  1.3136,
          1.0564,  1.0944,  0.9818,  0.4560,  0.5256,  0.3235,  0.8244,  0.8230,
          1.1684,  1.1993,  1.1697,  0.9525,  0.3812,  0.8587,  0.4630,  1.2971,
          0.9275,  0.5207,  1.0706,  0.3638,  0.9545,  0.8942,  1.4615,  0.4965,
          0.5783,  1.1526,  0.7037,  0.2736,  1.1224,  0.8441,  1.3193,  0.4848,
          1.1872,  0.7389,  1.3537,  1.3811,  1.3848,  1.3106,  1.0272,  0.8117,
          0.3125,  0.7764,  1.2297,  1.2933,  0.7629,  1.1371,  0.6398,  0.7844,
          0.6036,  0.7982,  0.7943,  1.0151,  1.4763,  0.4762,  1.5023,  0.7819,
          0.8792,  0.9180,  1.5636,  0.9083,  1.2299,  0.5528,  1.0654,  1.1923,
          0.5726,  1.3093,  1.0671,  0.5962,  0.8412,  0.9898,  0.7439,  1.4024,
          0.7482,  1.2796,  0.5359,  0.8617,  1.6638,  0.4673,  0.9210,  0.7744,
          0.4150,  0.8284,  1.5003,  1.0432,  1.3232,  0.7029,  1.0634,  1.3617,
          0.4481,  1.7832,  1.4513,  0.3708,  1.2147,  0.7989,  0.6738,  1.2473,
          0.5284,  0.7736,  0.7653,  0.9141,  0.6158,  1.0538,  0.8028,  0.5680,
          0.7306,  0.7251,  0.5713,  1.0277,  0.7940,  1.3764,  1.0530,  1.1651,
          0.9866,  0.7985,  0.4572,  1.7840,  0.9543,  1.3683,  1.5765,  0.8700,
          1.7705,  1.4082,  0.9951,  1.3511,  0.6241,  1.0013,  0.8580,  1.5490,
          0.4503,  1.5001,  0.6366,  0.5422,  0.5813,  0.6054,  0.8225,  1.4629,
          1.1369,  1.1149,  0.9897,  0.5908,  1.1556,  1.0668,  1.0681,  1.2931,
          1.3186,  1.6571,  1.2337,  1.1786,  0.3122,  1.3432,  0.4664,  1.3275,
          0.8935,  1.3531,  0.3623,  0.9588,  0.7121,  1.3015,  0.5918,  0.7119,
          1.4998,  0.9166,  0.7392,  0.8375,  1.4440,  0.7693,  1.5188,  0.7161,
          1.7080,  0.9777,  1.7753,  0.5609,  0.5777,  1.4668,  0.4656,  1.2391,
          1.0472,  1.6088,  0.5288,  1.3202,  1.0422,  1.5672,  0.5313,  0.6208,
          0.9242,  0.6966,  0.8236,  0.6820,  1.4158,  0.4520,  0.7107,  0.6520,
          1.3920,  0.2788,  1.5411,  0.4379,  0.8813,  1.3793,  0.5347,  1.5515,
          0.7921,  1.4918,  0.7757,  1.3189,  1.1742,  1.0016,  0.5763,  0.5182,
          0.8160,  0.5317,  1.0277,  0.5727,  0.9404,  0.7382,  0.8309,  0.5853,
          1.2892,  0.7444,  1.2416,  0.7236,  0.4649,  0.3667,  0.2508,  0.2357,
          0.3154,  0.2120,  0.4290,  0.8762,  0.3952,  0.7920,  0.9921,  0.4856,
          0.6822,  0.3044,  0.8608,  0.5604,  0.3556,  0.9117,  0.4548,  0.9791,
          0.4027,  0.6990,  0.6295,  1.0339,  0.4804,  0.6635,  0.8059,  0.6112,
          0.9352,  1.1341,  0.1173,  1.1318,  0.6794,  1.0527,  0.2638,  1.2048,
          0.6968,  0.6272,  0.8840,  0.2351,  0.8897,  0.3030,  0.5642,  0.7079,
          0.3752,  1.4969,  0.7190,  1.0617, -0.1268,  1.2388,  1.1162,  0.3399,
          0.9976,  0.6704,  0.3808,  1.2577,  0.6573,  0.5776,  0.7478,  0.7564,
          0.5484,  0.4399,  0.4123,  1.1702,  0.4022,  0.3048,  0.6273,  0.5845,
          0.3520,  1.0128,  0.4261,  0.3855,  0.5818,  0.5230,  0.5892,  0.4545,
          0.1997,  0.4886,  0.8897,  1.1786,  0.3514,  0.8931,  1.1991,  0.6499,
          1.3221,  0.3846,  0.8665,  1.5290,  0.7854,  1.0142,  1.0172,  1.0796,
          1.3174,  1.1982,  1.4273,  1.5014,  1.1328,  1.3105,  1.1243,  1.5218,
          0.8087,  1.3279,  0.2834,  1.2605,  1.2083,  0.3211,  1.3607,  0.6441,
          0.7145,  1.1517,  0.4895,  1.0223,  1.0859,  1.2570,  1.1619,  1.1674,
          1.0437,  1.3424,  0.5062,  1.4353,  1.2756,  1.4997,  1.1331,  1.0219,
          1.4966,  1.2088,  1.0814,  1.1072,  1.5027,  0.6142,  1.3704,  0.4539,
          0.0583,  1.2788,  1.0644,  1.2935,  1.2215,  1.1524,  0.8082,  1.2073,
          0.1930,  1.2922,  1.2762,  1.3696,  1.1465,  1.1555,  1.3505,  1.0658,
          1.0903,  1.1351,  0.0358,  1.2459,  0.7096,  1.1534,  0.4088,  1.2147,
          1.4349,  0.4311,  1.5032,  0.5740,  1.2840,  1.0825,  0.9292,  0.9173,
          1.1007,  1.3032,  0.7524,  1.3689,  1.4371,  0.6629,  1.2786,  0.5115,
          0.2387,  1.2473,  0.7558,  0.6465,  0.5266,  0.6530,  1.4513,  0.6843,
          1.2856,  0.3226,  0.3045,  0.7897,  1.1006,  0.4803,  1.1832,  0.6170,
          0.7157,  0.5671,  0.4540,  0.7142,  0.8158,  0.4668,  1.0025,  0.7494,
          0.2448,  0.6911,  0.2428,  0.5455,  1.5179,  1.4588,  0.4497,  1.6615,
          1.2320,  1.2814,  1.1893,  1.5396,  1.4883,  1.1781,  1.6550,  1.7746,
          1.4329,  0.5336,  1.5015,  0.7923,  1.4467,  1.1760,  1.2586,  1.7123,
          1.5650,  1.6145,  0.4457,  1.3389,  0.9769,  1.5873,  1.3618,  1.5885,
          1.1632,  0.4306,  1.3496,  0.8142,  0.8936,  0.9093,  0.6530,  1.5121]])

threshold = 1e-2
para_input = torch.where(abs(para_input) < threshold, torch.tensor(0.0), para_input)

band.init_calculate_model("/data/home/kongfh/DFTBAI1/example/test_TB/MX2/MX2_d(no_z2)_p_3n.pkl",
                              para = para_input
                              )
band.plot_model(band.content['k_vector'],save_path="/data/home/kongfh/DFTBAI1/example/test_TB/MX2/calculate_band.png",
                    select_band=model_index
                    )

print(para_input.shape)
band.plot_compare(band.content['k_vector'],save_path="/data/home/kongfh/DFTBAI1/example/test_TB/MX2/compare.png",
                  model_index=model_index,band_index=band_index,title="MnTe2")


